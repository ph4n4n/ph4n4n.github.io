<!DOCTYPE html>
<html lang=vi>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Zero to Hero: RabbitMQ - Message Broker MasteryRabbitMQ là một message broker mạnh mẽ, hỗ trợ Advanced Message Queuing Protocol (AMQP) và nhiều protocol khác. Đây là giải pháp hàng đầu cho distributed">
<meta property="og:type" content="article">
<meta property="og:title" content="Zero to Hero: RabbitMQ - Message Broker Mastery">
<meta property="og:url" content="https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/index.html">
<meta property="og:site_name" content="ph4n4n&#39;s code notes &amp; tips">
<meta property="og:description" content="Zero to Hero: RabbitMQ - Message Broker MasteryRabbitMQ là một message broker mạnh mẽ, hỗ trợ Advanced Message Queuing Protocol (AMQP) và nhiều protocol khác. Đây là giải pháp hàng đầu cho distributed">
<meta property="og:locale" content="vi_VN">
<meta property="article:published_time" content="2025-06-26T09:00:08.000Z">
<meta property="article:modified_time" content="2025-06-27T07:36:21.034Z">
<meta property="article:author" content="ph4n4n">
<meta property="article:tag" content="microservices">
<meta property="article:tag" content="zero-to-hero">
<meta property="article:tag" content="backend">
<meta property="article:tag" content="rabbitmq">
<meta property="article:tag" content="message-broker">
<meta property="article:tag" content="queue">
<meta property="article:tag" content="amqp">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Zero to Hero: RabbitMQ - Message Broker Mastery</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- Monaco font override -->
    
<link rel="stylesheet" href="/css/monaco-override.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="ph4n4n&#39;s code notes &amp; tips" type="application/atom+xml" />
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/archives/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/Zero-to-hero-Series-Overview/">Zero to Hero</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Bài trước" href="/Zero-to-hero-Puppeteer/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Bài tiếp theo" href="/Zero-to-hero-Regexp/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Về đầu trang" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Chia sẻ bài viết" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Bài trước</span>
      <span id="i-next" class="info" style="display:none;">Bài tiếp theo</span>
      <span id="i-top" class="info" style="display:none;">Về đầu trang</span>
      <span id="i-share" class="info" style="display:none;">Chia sẻ bài viết</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&text=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&is_video=false&description=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: RabbitMQ - Message Broker Mastery&body=Check out this article: https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&name=Zero to Hero: RabbitMQ - Message Broker Mastery&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&t=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-RabbitMQ-Message-Broker-Mastery"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: RabbitMQ - Message Broker Mastery</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Gioi-thieu-va-khai-niem-co-ban"><span class="toc-number">1.1.</span> <span class="toc-text">1. Giới thiệu và khái niệm cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-la-gi"><span class="toc-number">1.1.1.</span> <span class="toc-text">RabbitMQ là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Core-Concepts"><span class="toc-number">1.1.2.</span> <span class="toc-text">Core Concepts:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-Cases"><span class="toc-number">1.1.3.</span> <span class="toc-text">Use Cases:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Cai-dat-va-setup-moi-truong"><span class="toc-number">1.2.</span> <span class="toc-text">2. Cài đặt và setup môi trường</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-Installation"><span class="toc-number">1.2.1.</span> <span class="toc-text">RabbitMQ Installation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js-Setup"><span class="toc-number">1.2.2.</span> <span class="toc-text">Node.js Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Environment-Configuration"><span class="toc-number">1.2.3.</span> <span class="toc-text">Environment Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Connection-Setup"><span class="toc-number">1.2.4.</span> <span class="toc-text">Basic Connection Setup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Cu-phap-va-cau-truc-co-ban"><span class="toc-number">1.3.</span> <span class="toc-text">3. Cú pháp và cấu trúc cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exchange-Types"><span class="toc-number">1.3.1.</span> <span class="toc-text">Exchange Types</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Producer"><span class="toc-number">1.3.2.</span> <span class="toc-text">Basic Producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Consumer"><span class="toc-number">1.3.3.</span> <span class="toc-text">Basic Consumer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Cac-tinh-nang-nang-cao"><span class="toc-number">1.4.</span> <span class="toc-text">4. Các tính năng nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Message-Acknowledgment"><span class="toc-number">1.4.1.</span> <span class="toc-text">Message Acknowledgment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dead-Letter-Exchange"><span class="toc-number">1.4.2.</span> <span class="toc-text">Dead Letter Exchange</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Message-Persistence"><span class="toc-number">1.4.3.</span> <span class="toc-text">Message Persistence</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Best-practices-va-patterns"><span class="toc-number">1.5.</span> <span class="toc-text">5. Best practices và patterns</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Connection-Management"><span class="toc-number">1.5.1.</span> <span class="toc-text">Connection Management</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error-Handling"><span class="toc-number">1.5.2.</span> <span class="toc-text">Error Handling</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Vi-du-thuc-te"><span class="toc-number">1.6.</span> <span class="toc-text">6. Ví dụ thực tế</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#E-commerce-Order-Processing"><span class="toc-number">1.6.1.</span> <span class="toc-text">E-commerce Order Processing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Microservices-Communication"><span class="toc-number">1.6.2.</span> <span class="toc-text">Microservices Communication</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Troubleshooting-va-tips"><span class="toc-number">1.7.</span> <span class="toc-text">7. Troubleshooting và tips</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Common-Issues"><span class="toc-number">1.7.1.</span> <span class="toc-text">Common Issues</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Debugging-Tips"><span class="toc-number">1.7.2.</span> <span class="toc-text">Debugging Tips</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Best-Practices"><span class="toc-number">1.7.3.</span> <span class="toc-text">Best Practices</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Tai-lieu-tham-khao"><span class="toc-number">1.8.</span> <span class="toc-text">8. Tài liệu tham khảo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Official-Documentation"><span class="toc-number">1.8.1.</span> <span class="toc-text">Official Documentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Learning-Resources"><span class="toc-number">1.8.2.</span> <span class="toc-text">Learning Resources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tools-Extensions"><span class="toc-number">1.8.3.</span> <span class="toc-text">Tools &amp; Extensions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance-Monitoring"><span class="toc-number">1.8.4.</span> <span class="toc-text">Performance &amp; Monitoring</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security"><span class="toc-number">1.8.5.</span> <span class="toc-text">Security</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deployment-Operations"><span class="toc-number">1.8.6.</span> <span class="toc-text">Deployment &amp; Operations</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Zero to Hero: RabbitMQ - Message Broker Mastery
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ph4n4n</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-06-26T09:00:08.000Z" class="dt-published" itemprop="datePublished">2025-06-26</time>
        
        (Updated: <time datetime="2025-06-27T07:36:21.034Z" class="dt-updated" itemprop="dateModified">2025-06-27</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Message-Broker/">Message Broker</a> › <a class="category-link" href="/categories/Message-Broker/Microservices/">Microservices</a> › <a class="category-link" href="/categories/Message-Broker/Microservices/Backend/">Backend</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/amqp/" rel="tag">amqp</a>, <a class="p-category" href="/tags/backend/" rel="tag">backend</a>, <a class="p-category" href="/tags/message-broker/" rel="tag">message-broker</a>, <a class="p-category" href="/tags/microservices/" rel="tag">microservices</a>, <a class="p-category" href="/tags/queue/" rel="tag">queue</a>, <a class="p-category" href="/tags/rabbitmq/" rel="tag">rabbitmq</a>, <a class="p-category" href="/tags/zero-to-hero/" rel="tag">zero-to-hero</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Zero-to-Hero-RabbitMQ-Message-Broker-Mastery"><a href="#Zero-to-Hero-RabbitMQ-Message-Broker-Mastery" class="headerlink" title="Zero to Hero: RabbitMQ - Message Broker Mastery"></a>Zero to Hero: RabbitMQ - Message Broker Mastery</h1><p>RabbitMQ là một message broker mạnh mẽ, hỗ trợ Advanced Message Queuing Protocol (AMQP) và nhiều protocol khác. Đây là giải pháp hàng đầu cho distributed systems, microservices architecture, và asynchronous processing.</p>
<h2 id="1-Gioi-thieu-va-khai-niem-co-ban"><a href="#1-Gioi-thieu-va-khai-niem-co-ban" class="headerlink" title="1. Giới thiệu và khái niệm cơ bản"></a>1. Giới thiệu và khái niệm cơ bản</h2><h3 id="RabbitMQ-la-gi"><a href="#RabbitMQ-la-gi" class="headerlink" title="RabbitMQ là gì?"></a>RabbitMQ là gì?</h3><p>RabbitMQ là một open-source message broker cung cấp:</p>
<ul>
<li><strong>Message Queuing</strong>: Lưu trữ và forward messages</li>
<li><strong>Protocol Support</strong>: AMQP, MQTT, STOMP, HTTP</li>
<li><strong>Clustering</strong>: High availability và scalability</li>
<li><strong>Management UI</strong>: Web-based management interface</li>
<li><strong>Plugin System</strong>: Extensible architecture</li>
</ul>
<h3 id="Core-Concepts"><a href="#Core-Concepts" class="headerlink" title="Core Concepts:"></a>Core Concepts:</h3><ul>
<li><strong>Producer</strong>: Ứng dụng gửi messages</li>
<li><strong>Consumer</strong>: Ứng dụng nhận messages</li>
<li><strong>Queue</strong>: Buffer lưu trữ messages</li>
<li><strong>Exchange</strong>: Router định tuyến messages</li>
<li><strong>Binding</strong>: Quy tắc kết nối exchange và queue</li>
<li><strong>Channel</strong>: Virtual connection trong connection</li>
</ul>
<h3 id="Use-Cases"><a href="#Use-Cases" class="headerlink" title="Use Cases:"></a>Use Cases:</h3><ul>
<li><strong>Microservices Communication</strong>: Service-to-service messaging</li>
<li><strong>Task Queues</strong>: Background job processing</li>
<li><strong>Event Streaming</strong>: Real-time event processing</li>
<li><strong>Load Balancing</strong>: Distribute work across workers</li>
<li><strong>Reliable Messaging</strong>: Guaranteed message delivery</li>
</ul>
<h2 id="2-Cai-dat-va-setup-moi-truong"><a href="#2-Cai-dat-va-setup-moi-truong" class="headerlink" title="2. Cài đặt và setup môi trường"></a>2. Cài đặt và setup môi trường</h2><h3 id="RabbitMQ-Installation"><a href="#RabbitMQ-Installation" class="headerlink" title="RabbitMQ Installation"></a>RabbitMQ Installation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu/Debian</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install rabbitmq-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># macOS với Homebrew</span></span><br><span class="line">brew install rabbitmq</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker</span></span><br><span class="line">docker run -d --name rabbitmq \</span><br><span class="line">  -p 5672:5672 \</span><br><span class="line">  -p 15672:15672 \</span><br><span class="line">  rabbitmq:3-management</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows</span></span><br><span class="line"><span class="comment"># Download từ https://www.rabbitmq.com/download.html</span></span><br></pre></td></tr></table></figure>

<h3 id="Node-js-Setup"><a href="#Node-js-Setup" class="headerlink" title="Node.js Setup"></a>Node.js Setup</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Cài đặt amqplib</span></span><br><span class="line">npm install amqplib</span><br><span class="line">npm install @types/amqplib --save-dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hoặc dùng amqp-connection-manager cho production</span></span><br><span class="line">npm install amqp-connection-manager</span><br></pre></td></tr></table></figure>

<h3 id="Environment-Configuration"><a href="#Environment-Configuration" class="headerlink" title="Environment Configuration"></a>Environment Configuration</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># .env</span><br><span class="line">RABBITMQ_URL=amqp://localhost:5672</span><br><span class="line">RABBITMQ_USERNAME=guest</span><br><span class="line">RABBITMQ_PASSWORD=guest</span><br><span class="line">RABBITMQ_HOST=localhost</span><br><span class="line">RABBITMQ_PORT=5672</span><br><span class="line">RABBITMQ_VHOST=/</span><br></pre></td></tr></table></figure>

<h3 id="Basic-Connection-Setup"><a href="#Basic-Connection-Setup" class="headerlink" title="Basic Connection Setup"></a>Basic Connection Setup</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib/rabbitmq.js</span></span><br><span class="line"><span class="keyword">const</span> amqp = <span class="built_in">require</span>(<span class="string">&#x27;amqplib&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RabbitMQConnection</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">connection</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">connect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">connection</span> = <span class="keyword">await</span> amqp.<span class="title function_">connect</span>(process.<span class="property">env</span>.<span class="property">RABBITMQ_URL</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">createChannel</span>();</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Connected to RabbitMQ&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Handle connection events</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;RabbitMQ connection error:&#x27;</span>, err);</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;RabbitMQ connection closed&#x27;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">channel</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to connect to RabbitMQ:&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">channel</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">connection</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">RabbitMQConnection</span>();</span><br></pre></td></tr></table></figure>

<h2 id="3-Cu-phap-va-cau-truc-co-ban"><a href="#3-Cu-phap-va-cau-truc-co-ban" class="headerlink" title="3. Cú pháp và cấu trúc cơ bản"></a>3. Cú pháp và cấu trúc cơ bản</h2><h3 id="Exchange-Types"><a href="#Exchange-Types" class="headerlink" title="Exchange Types"></a>Exchange Types</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. Direct Exchange - Exact routing key matching</span></span><br><span class="line"><span class="keyword">await</span> channel.<span class="title function_">assertExchange</span>(<span class="string">&#x27;direct_exchange&#x27;</span>, <span class="string">&#x27;direct&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Topic Exchange - Pattern-based routing</span></span><br><span class="line"><span class="keyword">await</span> channel.<span class="title function_">assertExchange</span>(<span class="string">&#x27;topic_exchange&#x27;</span>, <span class="string">&#x27;topic&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Fanout Exchange - Broadcast to all queues</span></span><br><span class="line"><span class="keyword">await</span> channel.<span class="title function_">assertExchange</span>(<span class="string">&#x27;fanout_exchange&#x27;</span>, <span class="string">&#x27;fanout&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. Headers Exchange - Header-based routing</span></span><br><span class="line"><span class="keyword">await</span> channel.<span class="title function_">assertExchange</span>(<span class="string">&#x27;headers_exchange&#x27;</span>, <span class="string">&#x27;headers&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Basic-Producer"><a href="#Basic-Producer" class="headerlink" title="Basic Producer"></a>Basic Producer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// producer.js</span></span><br><span class="line"><span class="keyword">const</span> amqp = <span class="built_in">require</span>(<span class="string">&#x27;amqplib&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> rabbitmq = <span class="built_in">require</span>(<span class="string">&#x27;./lib/rabbitmq&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MessageProducer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">initialize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="keyword">await</span> rabbitmq.<span class="title function_">connect</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Declare exchange</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">assertExchange</span>(<span class="string">&#x27;user_events&#x27;</span>, <span class="string">&#x27;topic&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">durable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendMessage</span>(<span class="params">routingKey, message</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> messageBuffer = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(message));</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">publish</span>(<span class="string">&#x27;user_events&#x27;</span>, routingKey, messageBuffer, &#123;</span><br><span class="line">        <span class="attr">persistent</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">timestamp</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(),</span><br><span class="line">        <span class="attr">messageId</span>: <span class="title function_">generateMessageId</span>()</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Message sent to <span class="subst">$&#123;routingKey&#125;</span>:`</span>, result);</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to send message:&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendUserCreated</span>(<span class="params">userData</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;user.created&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;USER_CREATED&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: userData,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendUserUpdated</span>(<span class="params">userData</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;user.updated&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;USER_UPDATED&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: userData,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">MessageProducer</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Basic-Consumer"><a href="#Basic-Consumer" class="headerlink" title="Basic Consumer"></a>Basic Consumer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// consumer.js</span></span><br><span class="line"><span class="keyword">const</span> amqp = <span class="built_in">require</span>(<span class="string">&#x27;amqplib&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> rabbitmq = <span class="built_in">require</span>(<span class="string">&#x27;./lib/rabbitmq&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MessageConsumer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">initialize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="keyword">await</span> rabbitmq.<span class="title function_">connect</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Declare exchange</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">assertExchange</span>(<span class="string">&#x27;user_events&#x27;</span>, <span class="string">&#x27;topic&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">durable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Declare queue</span></span><br><span class="line">    <span class="keyword">const</span> queueResult = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">assertQueue</span>(<span class="string">&#x27;user_processing_queue&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">durable</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">arguments</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;x-message-ttl&#x27;</span>: <span class="number">60000</span>, <span class="comment">// 1 minute TTL</span></span><br><span class="line">        <span class="string">&#x27;x-max-length&#x27;</span>: <span class="number">1000</span>    <span class="comment">// Max 1000 messages</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Bind queue to exchange</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">bindQueue</span>(queueResult.<span class="property">queue</span>, <span class="string">&#x27;user_events&#x27;</span>, <span class="string">&#x27;user.*&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Consumer initialized&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">startConsuming</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">consume</span>(<span class="string">&#x27;user_processing_queue&#x27;</span>, <span class="title function_">async</span> (msg) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (msg !== <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> message = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(msg.<span class="property">content</span>.<span class="title function_">toString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received message:&#x27;</span>, message);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Process message</span></span><br><span class="line">            <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">processMessage</span>(message);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Acknowledge message</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">ack</span>(msg);</span><br><span class="line">          &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error processing message:&#x27;</span>, error);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Reject message and requeue</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">nack</span>(msg, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Started consuming messages&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to start consuming:&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">processMessage</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (message.<span class="property">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;USER_CREATED&#x27;</span>:</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">handleUserCreated</span>(message.<span class="property">data</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;USER_UPDATED&#x27;</span>:</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">handleUserUpdated</span>(message.<span class="property">data</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="attr">default</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Unknown message type:&#x27;</span>, message.<span class="property">type</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handleUserCreated</span>(<span class="params">userData</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Processing user created:&#x27;</span>, userData);</span><br><span class="line">    <span class="comment">// Implement user creation logic</span></span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handleUserUpdated</span>(<span class="params">userData</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Processing user updated:&#x27;</span>, userData);</span><br><span class="line">    <span class="comment">// Implement user update logic</span></span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">MessageConsumer</span>;</span><br></pre></td></tr></table></figure>

<h2 id="4-Cac-tinh-nang-nang-cao"><a href="#4-Cac-tinh-nang-nang-cao" class="headerlink" title="4. Các tính năng nâng cao"></a>4. Các tính năng nâng cao</h2><h3 id="Message-Acknowledgment"><a href="#Message-Acknowledgment" class="headerlink" title="Message Acknowledgment"></a>Message Acknowledgment</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Reliable message processing</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ReliableConsumer</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">processWithAck</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">consume</span>(<span class="string">&#x27;queue_name&#x27;</span>, <span class="title function_">async</span> (msg) =&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// Process message</span></span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">processMessage</span>(msg);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Acknowledge successful processing</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">ack</span>(msg);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Processing failed:&#x27;</span>, error);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Negative acknowledgment</span></span><br><span class="line">        <span class="comment">// false, true = requeue message</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">nack</span>(msg, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dead-Letter-Exchange"><a href="#Dead-Letter-Exchange" class="headerlink" title="Dead Letter Exchange"></a>Dead Letter Exchange</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Setup dead letter exchange</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">setupDeadLetterExchange</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// Declare dead letter exchange</span></span><br><span class="line">  <span class="keyword">await</span> channel.<span class="title function_">assertExchange</span>(<span class="string">&#x27;dlx_exchange&#x27;</span>, <span class="string">&#x27;direct&#x27;</span>, &#123; <span class="attr">durable</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Declare dead letter queue</span></span><br><span class="line">  <span class="keyword">await</span> channel.<span class="title function_">assertQueue</span>(<span class="string">&#x27;dlx_queue&#x27;</span>, &#123; <span class="attr">durable</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Bind dead letter queue to exchange</span></span><br><span class="line">  <span class="keyword">await</span> channel.<span class="title function_">bindQueue</span>(<span class="string">&#x27;dlx_queue&#x27;</span>, <span class="string">&#x27;dlx_exchange&#x27;</span>, <span class="string">&#x27;dead.letter&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Declare main queue with dead letter configuration</span></span><br><span class="line">  <span class="keyword">await</span> channel.<span class="title function_">assertQueue</span>(<span class="string">&#x27;main_queue&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">durable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">arguments</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;x-dead-letter-exchange&#x27;</span>: <span class="string">&#x27;dlx_exchange&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;x-dead-letter-routing-key&#x27;</span>: <span class="string">&#x27;dead.letter&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;x-message-ttl&#x27;</span>: <span class="number">30000</span> <span class="comment">// 30 seconds</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Message-Persistence"><a href="#Message-Persistence" class="headerlink" title="Message Persistence"></a>Message Persistence</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Persistent messages</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersistentProducer</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendPersistentMessage</span>(<span class="params">routingKey, message</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> messageBuffer = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(message));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">publish</span>(<span class="string">&#x27;exchange_name&#x27;</span>, routingKey, messageBuffer, &#123;</span><br><span class="line">      <span class="attr">persistent</span>: <span class="literal">true</span>,           <span class="comment">// Message persistence</span></span><br><span class="line">      <span class="attr">deliveryMode</span>: <span class="number">2</span>,           <span class="comment">// Persistent delivery mode</span></span><br><span class="line">      <span class="attr">priority</span>: <span class="number">5</span>,               <span class="comment">// Message priority</span></span><br><span class="line">      <span class="attr">timestamp</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(),</span><br><span class="line">      <span class="attr">messageId</span>: <span class="title function_">generateMessageId</span>(),</span><br><span class="line">      <span class="attr">correlationId</span>: <span class="title function_">generateCorrelationId</span>(),</span><br><span class="line">      <span class="attr">replyTo</span>: <span class="string">&#x27;reply_queue&#x27;</span>,</span><br><span class="line">      <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;x-custom-header&#x27;</span>: <span class="string">&#x27;value&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-Best-practices-va-patterns"><a href="#5-Best-practices-va-patterns" class="headerlink" title="5. Best practices và patterns"></a>5. Best practices và patterns</h2><h3 id="Connection-Management"><a href="#Connection-Management" class="headerlink" title="Connection Management"></a>Connection Management</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Connection pooling và management</span></span><br><span class="line"><span class="keyword">const</span> amqp = <span class="built_in">require</span>(<span class="string">&#x27;amqplib&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">EventEmitter</span> = <span class="built_in">require</span>(<span class="string">&#x27;events&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RabbitMQManager</span> <span class="keyword">extends</span> <span class="title class_ inherited__">EventEmitter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">connection</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">reconnectAttempts</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">maxReconnectAttempts</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">reconnectDelay</span> = <span class="number">1000</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">connect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">connection</span> = <span class="keyword">await</span> amqp.<span class="title function_">connect</span>(process.<span class="property">env</span>.<span class="property">RABBITMQ_URL</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">channel</span> = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">createChannel</span>();</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">reconnectAttempts</span> = <span class="number">0</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&#x27;connected&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Setup connection event handlers</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleConnectionError</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="variable language_">this</span>.<span class="property">handleConnectionClose</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">channel</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&#x27;error&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">handleReconnect</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handleConnectionError</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;RabbitMQ connection error:&#x27;</span>, error);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&#x27;error&#x27;</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handleConnectionClose</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;RabbitMQ connection closed&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&#x27;disconnected&#x27;</span>);</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">handleReconnect</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handleReconnect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">reconnectAttempts</span> &lt; <span class="variable language_">this</span>.<span class="property">maxReconnectAttempts</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">reconnectAttempts</span>++;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Reconnecting... Attempt <span class="subst">$&#123;<span class="variable language_">this</span>.reconnectAttempts&#125;</span>`</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">connect</span>();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Reconnection failed:&#x27;</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="variable language_">this</span>.<span class="property">reconnectDelay</span> * <span class="variable language_">this</span>.<span class="property">reconnectAttempts</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&#x27;maxReconnectAttemptsReached&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">close</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">channel</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">connection</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Comprehensive error handling</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RobustConsumer</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">consumeWithRetry</span>(<span class="params">queueName, processor, options = &#123;&#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">      maxRetries = <span class="number">3</span>,</span><br><span class="line">      retryDelay = <span class="number">1000</span>,</span><br><span class="line">      backoffMultiplier = <span class="number">2</span></span><br><span class="line">    &#125; = options;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">consume</span>(queueName, <span class="title function_">async</span> (msg) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (!msg) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> retries = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">let</span> delay = retryDelay;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (retries &lt; maxRetries) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">await</span> <span class="title function_">processor</span>(msg);</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">ack</span>(msg);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">          retries++;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Processing failed (attempt <span class="subst">$&#123;retries&#125;</span>):`</span>, error);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (retries &gt;= maxRetries) &#123;</span><br><span class="line">            <span class="comment">// Send to dead letter queue</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">nack</span>(msg, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">logFailedMessage</span>(msg, error);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Wait before retry</span></span><br><span class="line">            <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, delay));</span><br><span class="line">            delay *= backoffMultiplier;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">logFailedMessage</span>(<span class="params">msg, error</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> failedMessage = &#123;</span><br><span class="line">      <span class="attr">content</span>: msg.<span class="property">content</span>.<span class="title function_">toString</span>(),</span><br><span class="line">      <span class="attr">properties</span>: msg.<span class="property">properties</span>,</span><br><span class="line">      <span class="attr">error</span>: error.<span class="property">message</span>,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Log to file or database</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed message logged:&#x27;</span>, failedMessage);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-Vi-du-thuc-te"><a href="#6-Vi-du-thuc-te" class="headerlink" title="6. Ví dụ thực tế"></a>6. Ví dụ thực tế</h2><h3 id="E-commerce-Order-Processing"><a href="#E-commerce-Order-Processing" class="headerlink" title="E-commerce Order Processing"></a>E-commerce Order Processing</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Order processing system</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OrderProcessingSystem</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">producer</span> = <span class="keyword">new</span> <span class="title class_">MessageProducer</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">consumer</span> = <span class="keyword">new</span> <span class="title class_">MessageConsumer</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">initialize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">initialize</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">consumer</span>.<span class="title function_">initialize</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Setup order processing queue</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">setupOrderQueues</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">setupOrderQueues</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> channel = <span class="keyword">await</span> rabbitmq.<span class="title function_">connect</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Order events exchange</span></span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">assertExchange</span>(<span class="string">&#x27;order_events&#x27;</span>, <span class="string">&#x27;topic&#x27;</span>, &#123; <span class="attr">durable</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Order processing queue</span></span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">assertQueue</span>(<span class="string">&#x27;order_processing&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">durable</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">arguments</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;x-dead-letter-exchange&#x27;</span>: <span class="string">&#x27;dlx_exchange&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;x-message-ttl&#x27;</span>: <span class="number">300000</span> <span class="comment">// 5 minutes</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Order notification queue</span></span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">assertQueue</span>(<span class="string">&#x27;order_notifications&#x27;</span>, &#123; <span class="attr">durable</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Bind queues</span></span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">bindQueue</span>(<span class="string">&#x27;order_processing&#x27;</span>, <span class="string">&#x27;order_events&#x27;</span>, <span class="string">&#x27;order.*&#x27;</span>);</span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">bindQueue</span>(<span class="string">&#x27;order_notifications&#x27;</span>, <span class="string">&#x27;order_events&#x27;</span>, <span class="string">&#x27;order.created&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">processOrder</span>(<span class="params">orderData</span>) &#123;</span><br><span class="line">    <span class="comment">// Send order created event</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;order.created&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">orderId</span>: orderData.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">userId</span>: orderData.<span class="property">userId</span>,</span><br><span class="line">      <span class="attr">items</span>: orderData.<span class="property">items</span>,</span><br><span class="line">      <span class="attr">total</span>: orderData.<span class="property">total</span>,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Send to inventory service</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;inventory.check&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">orderId</span>: orderData.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">items</span>: orderData.<span class="property">items</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Send to payment service</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;payment.process&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">orderId</span>: orderData.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">amount</span>: orderData.<span class="property">total</span>,</span><br><span class="line">      <span class="attr">paymentMethod</span>: orderData.<span class="property">paymentMethod</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handleOrderCreated</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; orderId, userId, items, total &#125; = message.<span class="property">data</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Processing order <span class="subst">$&#123;orderId&#125;</span> for user <span class="subst">$&#123;userId&#125;</span>`</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Update order status</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">updateOrderStatus</span>(orderId, <span class="string">&#x27;PROCESSING&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Send confirmation email</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">sendOrderConfirmation</span>(userId, orderId);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Update inventory</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">updateInventory</span>(items);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handlePaymentProcessed</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; orderId, success, transactionId &#125; = message.<span class="property">data</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (success) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">updateOrderStatus</span>(orderId, <span class="string">&#x27;PAID&#x27;</span>);</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;order.paid&#x27;</span>, &#123;</span><br><span class="line">        orderId,</span><br><span class="line">        transactionId,</span><br><span class="line">        <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">updateOrderStatus</span>(orderId, <span class="string">&#x27;PAYMENT_FAILED&#x27;</span>);</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;order.payment_failed&#x27;</span>, &#123;</span><br><span class="line">        orderId,</span><br><span class="line">        <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Microservices-Communication"><a href="#Microservices-Communication" class="headerlink" title="Microservices Communication"></a>Microservices Communication</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// User service</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">createUser</span>(<span class="params">userData</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">saveUser</span>(userData);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Publish user created event</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;user.created&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">userId</span>: user.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">email</span>: user.<span class="property">email</span>,</span><br><span class="line">      <span class="attr">name</span>: user.<span class="property">name</span>,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">updateUser</span>(<span class="params">userId, userData</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">updateUserData</span>(userId, userData);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Publish user updated event</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">producer</span>.<span class="title function_">sendMessage</span>(<span class="string">&#x27;user.updated&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">userId</span>: user.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">changes</span>: userData,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Notification service</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NotificationService</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">initialize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">consumer</span>.<span class="title function_">initialize</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">setupNotificationQueues</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">setupNotificationQueues</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> channel = <span class="keyword">await</span> rabbitmq.<span class="title function_">connect</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">assertExchange</span>(<span class="string">&#x27;user_events&#x27;</span>, <span class="string">&#x27;topic&#x27;</span>, &#123; <span class="attr">durable</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">assertQueue</span>(<span class="string">&#x27;notification_queue&#x27;</span>, &#123; <span class="attr">durable</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> channel.<span class="title function_">bindQueue</span>(<span class="string">&#x27;notification_queue&#x27;</span>, <span class="string">&#x27;user_events&#x27;</span>, <span class="string">&#x27;user.*&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">handleUserEvent</span>(<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; type, data &#125; = message;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;USER_CREATED&#x27;</span>:</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">sendWelcomeEmail</span>(data.<span class="property">email</span>, data.<span class="property">name</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;USER_UPDATED&#x27;</span>:</span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">sendProfileUpdateNotification</span>(data.<span class="property">userId</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendWelcomeEmail</span>(<span class="params">email, name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Sending welcome email to <span class="subst">$&#123;email&#125;</span> for <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">    <span class="comment">// Email sending logic</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-Troubleshooting-va-tips"><a href="#7-Troubleshooting-va-tips" class="headerlink" title="7. Troubleshooting và tips"></a>7. Troubleshooting và tips</h2><h3 id="Common-Issues"><a href="#Common-Issues" class="headerlink" title="Common Issues"></a>Common Issues</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Connection issues</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConnectionTroubleshooter</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">diagnoseConnection</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Test basic connection</span></span><br><span class="line">      <span class="keyword">const</span> connection = <span class="keyword">await</span> amqp.<span class="title function_">connect</span>(process.<span class="property">env</span>.<span class="property">RABBITMQ_URL</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Connection successful&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Test channel creation</span></span><br><span class="line">      <span class="keyword">const</span> channel = <span class="keyword">await</span> connection.<span class="title function_">createChannel</span>();</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Channel creation successful&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Test queue declaration</span></span><br><span class="line">      <span class="keyword">await</span> channel.<span class="title function_">assertQueue</span>(<span class="string">&#x27;test_queue&#x27;</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Queue declaration successful&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">await</span> channel.<span class="title function_">close</span>();</span><br><span class="line">      <span class="keyword">await</span> connection.<span class="title function_">close</span>();</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Connection diagnosis failed:&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">error</span>: error.<span class="property">message</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">checkQueueHealth</span>(<span class="params">queueName</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> channel = <span class="keyword">await</span> rabbitmq.<span class="title function_">connect</span>();</span><br><span class="line">      <span class="keyword">const</span> queueInfo = <span class="keyword">await</span> channel.<span class="title function_">checkQueue</span>(queueName);</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Queue health:&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">name</span>: queueInfo.<span class="property">queue</span>,</span><br><span class="line">        <span class="attr">messageCount</span>: queueInfo.<span class="property">messageCount</span>,</span><br><span class="line">        <span class="attr">consumerCount</span>: queueInfo.<span class="property">consumerCount</span></span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">return</span> queueInfo;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Queue health check failed:&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Debugging-Tips"><a href="#Debugging-Tips" class="headerlink" title="Debugging Tips"></a>Debugging Tips</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Message tracing</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MessageTracer</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">traceId</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">generateTraceId</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`trace_<span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>_<span class="subst">$&#123;++<span class="variable language_">this</span>.traceId&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">sendWithTrace</span>(<span class="params">routingKey, message</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> traceId = <span class="variable language_">this</span>.<span class="title function_">generateTraceId</span>();</span><br><span class="line">    <span class="keyword">const</span> tracedMessage = &#123;</span><br><span class="line">      ...message,</span><br><span class="line">      traceId,</span><br><span class="line">      <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>()</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[<span class="subst">$&#123;traceId&#125;</span>] Sending message to <span class="subst">$&#123;routingKey&#125;</span>:`</span>, tracedMessage);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">publish</span>(<span class="string">&#x27;exchange_name&#x27;</span>, routingKey, </span><br><span class="line">      <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(tracedMessage)), &#123;</span><br><span class="line">        <span class="attr">persistent</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123; traceId &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[<span class="subst">$&#123;traceId&#125;</span>] Message sent:`</span>, result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">consumeWithTrace</span>(<span class="params">queueName, processor</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">consume</span>(queueName, <span class="title function_">async</span> (msg) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> message = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(msg.<span class="property">content</span>.<span class="title function_">toString</span>());</span><br><span class="line">      <span class="keyword">const</span> traceId = message.<span class="property">traceId</span> || <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[<span class="subst">$&#123;traceId&#125;</span>] Processing message:`</span>, message);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">processor</span>(message);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">ack</span>(msg);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[<span class="subst">$&#123;traceId&#125;</span>] Message processed successfully`</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`[<span class="subst">$&#123;traceId&#125;</span>] Processing failed:`</span>, error);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">channel</span>.<span class="title function_">nack</span>(msg, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Best practices checklist</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RabbitMQBestPractices</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">implementBestPractices</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 1. Use persistent messages for critical data</span></span><br><span class="line">    <span class="keyword">const</span> persistentOptions = &#123;</span><br><span class="line">      <span class="attr">persistent</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">deliveryMode</span>: <span class="number">2</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. Implement proper error handling</span></span><br><span class="line">    <span class="keyword">const</span> errorHandling = &#123;</span><br><span class="line">      <span class="attr">try</span>: <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="comment">// Message processing logic</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">catch</span>: <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Processing error:&#x27;</span>, error);</span><br><span class="line">        <span class="comment">// Implement retry logic or dead letter queue</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. Use appropriate exchange types</span></span><br><span class="line">    <span class="keyword">const</span> exchangeTypes = &#123;</span><br><span class="line">      <span class="attr">direct</span>: <span class="string">&#x27;For exact routing key matching&#x27;</span>,</span><br><span class="line">      <span class="attr">topic</span>: <span class="string">&#x27;For pattern-based routing&#x27;</span>,</span><br><span class="line">      <span class="attr">fanout</span>: <span class="string">&#x27;For broadcasting&#x27;</span>,</span><br><span class="line">      <span class="attr">headers</span>: <span class="string">&#x27;For header-based routing&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. Implement connection pooling</span></span><br><span class="line">    <span class="keyword">const</span> connectionPool = &#123;</span><br><span class="line">      <span class="attr">maxConnections</span>: <span class="number">10</span>,</span><br><span class="line">      <span class="attr">maxChannels</span>: <span class="number">100</span>,</span><br><span class="line">      <span class="attr">connectionTimeout</span>: <span class="number">30000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. Use publisher confirms</span></span><br><span class="line">    <span class="keyword">const</span> publisherConfirms = &#123;</span><br><span class="line">      <span class="attr">enableConfirms</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">waitForConfirmation</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">5000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. Implement proper queue configuration</span></span><br><span class="line">    <span class="keyword">const</span> queueConfig = &#123;</span><br><span class="line">      <span class="attr">durable</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">autoDelete</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">arguments</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;x-max-priority&#x27;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="string">&#x27;x-max-length&#x27;</span>: <span class="number">10000</span>,</span><br><span class="line">        <span class="string">&#x27;x-message-ttl&#x27;</span>: <span class="number">300000</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      persistentOptions,</span><br><span class="line">      errorHandling,</span><br><span class="line">      exchangeTypes,</span><br><span class="line">      connectionPool,</span><br><span class="line">      publisherConfirms,</span><br><span class="line">      queueConfig</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-Tai-lieu-tham-khao"><a href="#8-Tai-lieu-tham-khao" class="headerlink" title="8. Tài liệu tham khảo"></a>8. Tài liệu tham khảo</h2><h3 id="Official-Documentation"><a href="#Official-Documentation" class="headerlink" title="Official Documentation"></a>Official Documentation</h3><ul>
<li><a href="https://www.rabbitmq.com/documentation.html">RabbitMQ Documentation</a></li>
<li><a href="https://www.rabbitmq.com/amqp-0-9-1-reference.html">AMQP 0-9-1 Reference</a></li>
<li><a href="https://www.rabbitmq.com/tutorials/">RabbitMQ Tutorials</a></li>
</ul>
<h3 id="Learning-Resources"><a href="#Learning-Resources" class="headerlink" title="Learning Resources"></a>Learning Resources</h3><ul>
<li><a href="https://www.rabbitmq.com/tutorials/amqp-concepts.html">RabbitMQ Patterns</a></li>
<li><a href="https://www.rabbitmq.com/best-practices.html">RabbitMQ Best Practices</a></li>
<li><a href="https://www.rabbitmq.com/performance.html">RabbitMQ Performance</a></li>
</ul>
<h3 id="Tools-Extensions"><a href="#Tools-Extensions" class="headerlink" title="Tools &amp; Extensions"></a>Tools &amp; Extensions</h3><ul>
<li><a href="https://www.rabbitmq.com/management.html">RabbitMQ Management Plugin</a></li>
<li><a href="https://www.rabbitmq.com/cli.html">RabbitMQ CLI Tools</a></li>
<li><a href="https://www.rabbitmq.com/monitoring.html">RabbitMQ Monitoring</a></li>
</ul>
<h3 id="Performance-Monitoring"><a href="#Performance-Monitoring" class="headerlink" title="Performance &amp; Monitoring"></a>Performance &amp; Monitoring</h3><ul>
<li><a href="https://www.rabbitmq.com/performance.html">RabbitMQ Performance Tuning</a></li>
<li><a href="https://www.rabbitmq.com/monitoring.html">RabbitMQ Monitoring</a></li>
<li><a href="https://www.rabbitmq.com/monitoring.html#metrics">RabbitMQ Metrics</a></li>
</ul>
<h3 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h3><ul>
<li><a href="https://www.rabbitmq.com/security.html">RabbitMQ Security</a></li>
<li><a href="https://www.rabbitmq.com/access-control.html">RabbitMQ Access Control</a></li>
<li><a href="https://www.rabbitmq.com/ssl.html">RabbitMQ TLS&#x2F;SSL</a></li>
</ul>
<h3 id="Deployment-Operations"><a href="#Deployment-Operations" class="headerlink" title="Deployment &amp; Operations"></a>Deployment &amp; Operations</h3><ul>
<li><a href="https://www.rabbitmq.com/clustering.html">RabbitMQ Clustering</a></li>
<li><a href="https://www.rabbitmq.com/ha.html">RabbitMQ High Availability</a></li>
<li><a href="https://www.rabbitmq.com/download.html#docker">RabbitMQ Docker</a></li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Vui lòng kích hoạt JavaScript để xem các bình luận.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/archives/">Trang chủ</a></li>
        
          <li><a href="/Zero-to-hero-Series-Overview/">Zero to Hero</a></li>
        
          <li><a href="/archives/">Bài viết</a></li>
        
          <li><a href="/about/">Giới thiệu</a></li>
        
          <li><a href="https://github.com/ph4n4n">Dự án</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-RabbitMQ-Message-Broker-Mastery"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: RabbitMQ - Message Broker Mastery</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Gioi-thieu-va-khai-niem-co-ban"><span class="toc-number">1.1.</span> <span class="toc-text">1. Giới thiệu và khái niệm cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-la-gi"><span class="toc-number">1.1.1.</span> <span class="toc-text">RabbitMQ là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Core-Concepts"><span class="toc-number">1.1.2.</span> <span class="toc-text">Core Concepts:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-Cases"><span class="toc-number">1.1.3.</span> <span class="toc-text">Use Cases:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Cai-dat-va-setup-moi-truong"><span class="toc-number">1.2.</span> <span class="toc-text">2. Cài đặt và setup môi trường</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-Installation"><span class="toc-number">1.2.1.</span> <span class="toc-text">RabbitMQ Installation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js-Setup"><span class="toc-number">1.2.2.</span> <span class="toc-text">Node.js Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Environment-Configuration"><span class="toc-number">1.2.3.</span> <span class="toc-text">Environment Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Connection-Setup"><span class="toc-number">1.2.4.</span> <span class="toc-text">Basic Connection Setup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Cu-phap-va-cau-truc-co-ban"><span class="toc-number">1.3.</span> <span class="toc-text">3. Cú pháp và cấu trúc cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exchange-Types"><span class="toc-number">1.3.1.</span> <span class="toc-text">Exchange Types</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Producer"><span class="toc-number">1.3.2.</span> <span class="toc-text">Basic Producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Consumer"><span class="toc-number">1.3.3.</span> <span class="toc-text">Basic Consumer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Cac-tinh-nang-nang-cao"><span class="toc-number">1.4.</span> <span class="toc-text">4. Các tính năng nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Message-Acknowledgment"><span class="toc-number">1.4.1.</span> <span class="toc-text">Message Acknowledgment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dead-Letter-Exchange"><span class="toc-number">1.4.2.</span> <span class="toc-text">Dead Letter Exchange</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Message-Persistence"><span class="toc-number">1.4.3.</span> <span class="toc-text">Message Persistence</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Best-practices-va-patterns"><span class="toc-number">1.5.</span> <span class="toc-text">5. Best practices và patterns</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Connection-Management"><span class="toc-number">1.5.1.</span> <span class="toc-text">Connection Management</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error-Handling"><span class="toc-number">1.5.2.</span> <span class="toc-text">Error Handling</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Vi-du-thuc-te"><span class="toc-number">1.6.</span> <span class="toc-text">6. Ví dụ thực tế</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#E-commerce-Order-Processing"><span class="toc-number">1.6.1.</span> <span class="toc-text">E-commerce Order Processing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Microservices-Communication"><span class="toc-number">1.6.2.</span> <span class="toc-text">Microservices Communication</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Troubleshooting-va-tips"><span class="toc-number">1.7.</span> <span class="toc-text">7. Troubleshooting và tips</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Common-Issues"><span class="toc-number">1.7.1.</span> <span class="toc-text">Common Issues</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Debugging-Tips"><span class="toc-number">1.7.2.</span> <span class="toc-text">Debugging Tips</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Best-Practices"><span class="toc-number">1.7.3.</span> <span class="toc-text">Best Practices</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Tai-lieu-tham-khao"><span class="toc-number">1.8.</span> <span class="toc-text">8. Tài liệu tham khảo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Official-Documentation"><span class="toc-number">1.8.1.</span> <span class="toc-text">Official Documentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Learning-Resources"><span class="toc-number">1.8.2.</span> <span class="toc-text">Learning Resources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tools-Extensions"><span class="toc-number">1.8.3.</span> <span class="toc-text">Tools &amp; Extensions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance-Monitoring"><span class="toc-number">1.8.4.</span> <span class="toc-text">Performance &amp; Monitoring</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security"><span class="toc-number">1.8.5.</span> <span class="toc-text">Security</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deployment-Operations"><span class="toc-number">1.8.6.</span> <span class="toc-text">Deployment &amp; Operations</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&text=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&is_video=false&description=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: RabbitMQ - Message Broker Mastery&body=Check out this article: https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&title=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&name=Zero to Hero: RabbitMQ - Message Broker Mastery&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/Zero-to-hero-RabbitMQ/&t=Zero to Hero: RabbitMQ - Message Broker Mastery"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Chia sẻ</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Về đầu trang</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Bản quyền &copy;
    
    
    2018-2025
    ph4n4n
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/archives/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/Zero-to-hero-Series-Overview/">Zero to Hero</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'https-ph4n4n-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->


<script>
(function() {
  var fallbackQuotes = [
    {q: 'Stay hungry, stay foolish.', a: 'Steve Jobs'},
    {q: 'Không có thành công nào mà không phải trả giá.', a: 'Ẩn danh'},
    {q: 'Simplicity is the soul of efficiency.', a: 'Austin Freeman'},
    {q: 'Hãy kiên trì, mọi thứ rồi sẽ ổn.', a: 'Ẩn danh'},
    {q: 'Code is like humor. When you have to explain it, it\'s bad.', a: 'Cory House'},
    {q: 'Chỉ cần bạn không dừng lại thì việc bạn tiến chậm cũng không là vấn đề.', a: 'Khổng Tử'},
    {q: 'The best way to get started is to quit talking and begin doing.', a: 'Walt Disney'},
    {q: 'Muốn đi nhanh thì đi một mình, muốn đi xa thì đi cùng nhau.', a: 'Tục ngữ'},
    {q: 'First, solve the problem. Then, write the code.', a: 'John Johnson'},
    {q: 'Đừng sợ thất bại, hãy sợ không thử.', a: 'Ẩn danh'},
    {q: 'No code no bug, no bug no life.', a: 'ph4n4n'},
    {q: 'No code no bug, no code no food.', a: 'ph4n4n'},
    {q: 'The only way to do great work is to love what you do.', a: 'Steve Jobs'},
    {q: 'Je suis món ennemi.', a: 'ph4n4n'},
    {q: 'Chết không phải lúc trái tim ngừng đập, chết là khi ý chí ngừng tiến lên.', a: 'ChatGPT'},
  ];
  var el = document.getElementById('random-quote');
  function showQuote(q, a) {
    if (el) el.innerHTML = q + (a ? ' <span style="font-size:0.95em;color:#888;">– ' + a + '</span>' : '');
  }
  function showFallback() {
    var r = fallbackQuotes[Math.floor(Math.random() * fallbackQuotes.length)];
    showQuote(r.q, r.a);
  }
  fetch('https://zenquotes.io/api/random')
    .then(function(res) { return res.ok ? res.json() : Promise.reject(); })
    .then(function(data) {
      if (Array.isArray(data) && data[0] && data[0].q) {
        showQuote(data[0].q, data[0].a);
      } else {
        showFallback();
      }
    })
    .catch(showFallback);
})();
</script>
</body>
</html>
