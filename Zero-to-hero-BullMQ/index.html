<!DOCTYPE html>
<html lang=vi>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Zero to Hero: BullMQBullMQ là một thư viện queue mạnh mẽ cho Node.js, được xây dựng trên Redis. Nó cung cấp khả năng xử lý job bất đồng bộ với các tính năng như retry, delay, priority, và monitoring.">
<meta property="og:type" content="article">
<meta property="og:title" content="Zero to Hero: BullMQ">
<meta property="og:url" content="https://ph4n4n.github.io/Zero-to-hero-BullMQ/index.html">
<meta property="og:site_name" content="ph4n4n&#39;s code notes &amp; tips">
<meta property="og:description" content="Zero to Hero: BullMQBullMQ là một thư viện queue mạnh mẽ cho Node.js, được xây dựng trên Redis. Nó cung cấp khả năng xử lý job bất đồng bộ với các tính năng như retry, delay, priority, và monitoring.">
<meta property="og:locale" content="vi_VN">
<meta property="article:published_time" content="2025-06-26T09:02:07.000Z">
<meta property="article:modified_time" content="2025-06-27T07:59:53.957Z">
<meta property="article:author" content="ph4n4n">
<meta property="article:tag" content="Node.js">
<meta property="article:tag" content="BullMQ">
<meta property="article:tag" content="Queue">
<meta property="article:tag" content="Redis">
<meta property="article:tag" content="Job Processing">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Zero to Hero: BullMQ</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- Monaco font override -->
    
<link rel="stylesheet" href="/css/monaco-override.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="ph4n4n&#39;s code notes &amp; tips" type="application/atom+xml" />
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/archives/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/Zero-to-hero-Series-Overview/">Zero to Hero</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Bài trước" href="/2025/06/26/NodeJS-lifecircle/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Bài tiếp theo" href="/Zero-to-hero-Golang/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Về đầu trang" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Chia sẻ bài viết" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Bài trước</span>
      <span id="i-next" class="info" style="display:none;">Bài tiếp theo</span>
      <span id="i-top" class="info" style="display:none;">Về đầu trang</span>
      <span id="i-share" class="info" style="display:none;">Chia sẻ bài viết</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/Zero-to-hero-BullMQ/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&text=Zero to Hero: BullMQ"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&is_video=false&description=Zero to Hero: BullMQ"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: BullMQ&body=Check out this article: https://ph4n4n.github.io/Zero-to-hero-BullMQ/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&name=Zero to Hero: BullMQ&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&t=Zero to Hero: BullMQ"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-BullMQ"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: BullMQ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Muc-luc"><span class="toc-number">1.1.</span> <span class="toc-text">Mục lục</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gioi-thieu"><span class="toc-number">1.2.</span> <span class="toc-text">Giới thiệu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cai-dat"><span class="toc-number">1.3.</span> <span class="toc-text">Cài đặt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cau-truc-co-ban"><span class="toc-number">1.4.</span> <span class="toc-text">Cấu trúc cơ bản</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Producer-va-Consumer"><span class="toc-number">1.5.</span> <span class="toc-text">Producer và Consumer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Producer"><span class="toc-number">1.5.1.</span> <span class="toc-text">Producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Consumer"><span class="toc-number">1.5.2.</span> <span class="toc-text">Consumer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Job-Options"><span class="toc-number">1.6.</span> <span class="toc-text">Job Options</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Retry-va-Error-Handling"><span class="toc-number">1.7.</span> <span class="toc-text">Retry và Error Handling</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Delay-va-Scheduling"><span class="toc-number">1.8.</span> <span class="toc-text">Delay và Scheduling</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Priority"><span class="toc-number">1.9.</span> <span class="toc-text">Priority</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Concurrency"><span class="toc-number">1.10.</span> <span class="toc-text">Concurrency</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Monitoring"><span class="toc-number">1.11.</span> <span class="toc-text">Monitoring</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Queue-Events"><span class="toc-number">1.11.1.</span> <span class="toc-text">Queue Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Queue-Metrics"><span class="toc-number">1.11.2.</span> <span class="toc-text">Queue Metrics</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Advanced-Features"><span class="toc-number">1.12.</span> <span class="toc-text">Advanced Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Job-Dependencies"><span class="toc-number">1.12.1.</span> <span class="toc-text">Job Dependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Job-Progress"><span class="toc-number">1.12.2.</span> <span class="toc-text">Job Progress</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Job-Logs"><span class="toc-number">1.12.3.</span> <span class="toc-text">Job Logs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rate-Limiting"><span class="toc-number">1.12.4.</span> <span class="toc-text">Rate Limiting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Best-Practices"><span class="toc-number">1.13.</span> <span class="toc-text">Best Practices</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Error-Handling"><span class="toc-number">1.13.1.</span> <span class="toc-text">1. Error Handling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Resource-Management"><span class="toc-number">1.13.2.</span> <span class="toc-text">2. Resource Management</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Monitoring-va-Alerting"><span class="toc-number">1.13.3.</span> <span class="toc-text">3. Monitoring và Alerting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Performance-Optimization"><span class="toc-number">1.13.4.</span> <span class="toc-text">4. Performance Optimization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vi-du-thuc-te-Email-Service"><span class="toc-number">1.14.</span> <span class="toc-text">Ví dụ thực tế: Email Service</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ket-luan"><span class="toc-number">1.15.</span> <span class="toc-text">Kết luận</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Zero to Hero: BullMQ
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ph4n4n</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-06-26T09:02:07.000Z" class="dt-published" itemprop="datePublished">2025-06-26</time>
        
        (Updated: <time datetime="2025-06-27T07:59:53.957Z" class="dt-updated" itemprop="dateModified">2025-06-27</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/BullMQ/" rel="tag">BullMQ</a>, <a class="p-category" href="/tags/Job-Processing/" rel="tag">Job Processing</a>, <a class="p-category" href="/tags/Node-js/" rel="tag">Node.js</a>, <a class="p-category" href="/tags/Queue/" rel="tag">Queue</a>, <a class="p-category" href="/tags/Redis/" rel="tag">Redis</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Zero-to-Hero-BullMQ"><a href="#Zero-to-Hero-BullMQ" class="headerlink" title="Zero to Hero: BullMQ"></a>Zero to Hero: BullMQ</h1><p>BullMQ là một thư viện queue mạnh mẽ cho Node.js, được xây dựng trên Redis. Nó cung cấp khả năng xử lý job bất đồng bộ với các tính năng như retry, delay, priority, và monitoring.</p>
<h2 id="Muc-luc"><a href="#Muc-luc" class="headerlink" title="Mục lục"></a>Mục lục</h2><ul>
<li><a href="#gi%E1%BB%9Bi-thi%E1%BB%87u">Giới thiệu</a></li>
<li><a href="#c%C3%A0i-%C4%91%E1%BA%B7t">Cài đặt</a></li>
<li><a href="#c%E1%BA%A5u-tr%C3%BAc-c%C6%A1-b%E1%BA%A3n">Cấu trúc cơ bản</a></li>
<li><a href="#producer-v%C3%A0-consumer">Producer và Consumer</a></li>
<li><a href="#job-options">Job Options</a></li>
<li><a href="#retry-v%C3%A0-error-handling">Retry và Error Handling</a></li>
<li><a href="#delay-v%C3%A0-scheduling">Delay và Scheduling</a></li>
<li><a href="#priority">Priority</a></li>
<li><a href="#concurrency">Concurrency</a></li>
<li><a href="#monitoring">Monitoring</a></li>
<li><a href="#advanced-features">Advanced Features</a></li>
<li><a href="#best-practices">Best Practices</a></li>
</ul>
<h2 id="Gioi-thieu"><a href="#Gioi-thieu" class="headerlink" title="Giới thiệu"></a>Giới thiệu</h2><p>BullMQ là thế hệ tiếp theo của Bull, được viết hoàn toàn bằng TypeScript và hỗ trợ Redis 6.0+. Nó cung cấp:</p>
<ul>
<li><strong>Reliability</strong>: Jobs được lưu trữ trong Redis, đảm bảo không mất dữ liệu</li>
<li><strong>Performance</strong>: Xử lý hàng nghìn job mỗi giây</li>
<li><strong>Flexibility</strong>: Hỗ trợ nhiều loại job và options</li>
<li><strong>Monitoring</strong>: Dashboard và metrics tích hợp</li>
</ul>
<h2 id="Cai-dat"><a href="#Cai-dat" class="headerlink" title="Cài đặt"></a>Cài đặt</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install bullmq</span><br></pre></td></tr></table></figure>

<p>Cần Redis server chạy (có thể dùng Docker):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 6379:6379 redis:alpine</span><br></pre></td></tr></table></figure>

<h2 id="Cau-truc-co-ban"><a href="#Cau-truc-co-ban" class="headerlink" title="Cấu trúc cơ bản"></a>Cấu trúc cơ bản</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Queue</span>, <span class="title class_">Worker</span>, <span class="title class_">QueueScheduler</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;bullmq&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tạo queue</span></span><br><span class="line"><span class="keyword">const</span> queue = <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&#x27;email-queue&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tạo worker</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;email-queue&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Processing job:&#x27;</span>, job.<span class="property">id</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Job data:&#x27;</span>, job.<span class="property">data</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Xử lý job</span></span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">sendEmail</span>(job.<span class="property">data</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tạo scheduler (cho delayed jobs)</span></span><br><span class="line"><span class="keyword">const</span> scheduler = <span class="keyword">new</span> <span class="title class_">QueueScheduler</span>(<span class="string">&#x27;email-queue&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Producer-va-Consumer"><a href="#Producer-va-Consumer" class="headerlink" title="Producer và Consumer"></a>Producer và Consumer</h2><h3 id="Producer"><a href="#Producer" class="headerlink" title="Producer"></a>Producer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Queue</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;bullmq&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> emailQueue = <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&#x27;email-queue&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Thêm job đơn giản</span></span><br><span class="line"><span class="keyword">await</span> emailQueue.<span class="title function_">add</span>(<span class="string">&#x27;send-welcome&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">to</span>: <span class="string">&#x27;user@example.com&#x27;</span>,</span><br><span class="line">  <span class="attr">subject</span>: <span class="string">&#x27;Welcome!&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: <span class="string">&#x27;Welcome to our platform!&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Thêm job với options</span></span><br><span class="line"><span class="keyword">await</span> emailQueue.<span class="title function_">add</span>(<span class="string">&#x27;send-newsletter&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">to</span>: <span class="string">&#x27;user@example.com&#x27;</span>,</span><br><span class="line">  <span class="attr">subject</span>: <span class="string">&#x27;Weekly Newsletter&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: <span class="string">&#x27;Check out our latest updates!&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">delay</span>: <span class="number">5000</span>, <span class="comment">// Delay 5 giây</span></span><br><span class="line">  <span class="attr">attempts</span>: <span class="number">3</span>,  <span class="comment">// Retry 3 lần</span></span><br><span class="line">  <span class="attr">backoff</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;exponential&#x27;</span>,</span><br><span class="line">    <span class="attr">delay</span>: <span class="number">2000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Worker</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;bullmq&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;email-queue&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; to, subject, body &#125; = job.<span class="property">data</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">sendEmail</span>(to, subject, body);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Email sent to <span class="subst">$&#123;to&#125;</span>`</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to send email:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">throw</span> error; <span class="comment">// Job sẽ được retry</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">concurrency</span>: <span class="number">5</span> <span class="comment">// Xử lý 5 job cùng lúc</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Event handlers</span></span><br><span class="line">worker.<span class="title function_">on</span>(<span class="string">&#x27;completed&#x27;</span>, <span class="function">(<span class="params">job</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> completed`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">worker.<span class="title function_">on</span>(<span class="string">&#x27;failed&#x27;</span>, <span class="function">(<span class="params">job, err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> failed:`</span>, err.<span class="property">message</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Job-Options"><a href="#Job-Options" class="headerlink" title="Job Options"></a>Job Options</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;job-name&#x27;</span>, data, &#123;</span><br><span class="line">  <span class="comment">// Timing</span></span><br><span class="line">  <span class="attr">delay</span>: <span class="number">5000</span>,           <span class="comment">// Delay 5 giây</span></span><br><span class="line">  <span class="attr">priority</span>: <span class="number">10</span>,          <span class="comment">// Priority cao</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Retry</span></span><br><span class="line">  <span class="attr">attempts</span>: <span class="number">3</span>,           <span class="comment">// Số lần retry</span></span><br><span class="line">  <span class="attr">backoff</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;exponential&#x27;</span>, <span class="comment">// exponential, fixed</span></span><br><span class="line">    <span class="attr">delay</span>: <span class="number">2000</span></span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Job metadata</span></span><br><span class="line">  <span class="attr">jobId</span>: <span class="string">&#x27;custom-id&#x27;</span>,    <span class="comment">// Custom job ID</span></span><br><span class="line">  <span class="attr">removeOnComplete</span>: <span class="number">100</span>, <span class="comment">// Giữ 100 job completed</span></span><br><span class="line">  <span class="attr">removeOnFail</span>: <span class="number">50</span>,      <span class="comment">// Giữ 50 job failed</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Timeout</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">30000</span>,        <span class="comment">// Timeout 30 giây</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Stack trace</span></span><br><span class="line">  <span class="attr">stackTraceLimit</span>: <span class="number">10</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Retry-va-Error-Handling"><a href="#Retry-va-Error-Handling" class="headerlink" title="Retry và Error Handling"></a>Retry và Error Handling</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;email-queue&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; to, subject, body &#125; = job.<span class="property">data</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Kiểm tra điều kiện</span></span><br><span class="line">  <span class="keyword">if</span> (!to || !subject) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Missing required fields&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Xử lý với retry logic</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">sendEmail</span>(to, subject, body);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="comment">// Log error</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Attempt <span class="subst">$&#123;job.attemptsMade + <span class="number">1</span>&#125;</span> failed:`</span>, error);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Custom retry logic</span></span><br><span class="line">    <span class="keyword">if</span> (error.<span class="property">code</span> === <span class="string">&#x27;RATE_LIMIT&#x27;</span> &amp;&amp; job.<span class="property">attemptsMade</span> &lt; <span class="number">2</span>) &#123;</span><br><span class="line">      <span class="comment">// Đợi lâu hơn cho rate limit</span></span><br><span class="line">      <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">10000</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">attempts</span>: <span class="number">5</span>,</span><br><span class="line">  <span class="attr">backoff</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;exponential&#x27;</span>,</span><br><span class="line">    <span class="attr">delay</span>: <span class="number">2000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Delay-va-Scheduling"><a href="#Delay-va-Scheduling" class="headerlink" title="Delay và Scheduling"></a>Delay và Scheduling</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Delay đơn giản</span></span><br><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;reminder&#x27;</span>, &#123; <span class="attr">userId</span>: <span class="number">123</span> &#125;, &#123;</span><br><span class="line">  <span class="attr">delay</span>: <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 24 giờ</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Cron-like scheduling</span></span><br><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;daily-report&#x27;</span>, &#123;&#125;, &#123;</span><br><span class="line">  <span class="attr">repeat</span>: &#123;</span><br><span class="line">    <span class="attr">pattern</span>: <span class="string">&#x27;0 9 * * *&#x27;</span> <span class="comment">// 9:00 AM hàng ngày</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Repeat với interval</span></span><br><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;cleanup&#x27;</span>, &#123;&#125;, &#123;</span><br><span class="line">  <span class="attr">repeat</span>: &#123;</span><br><span class="line">    <span class="attr">every</span>: <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// Mỗi giờ</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Repeat với limit</span></span><br><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;batch-process&#x27;</span>, &#123;&#125;, &#123;</span><br><span class="line">  <span class="attr">repeat</span>: &#123;</span><br><span class="line">    <span class="attr">every</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">limit</span>: <span class="number">10</span> <span class="comment">// Chỉ chạy 10 lần</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Priority"><a href="#Priority" class="headerlink" title="Priority"></a>Priority</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Job với priority cao</span></span><br><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;urgent-email&#x27;</span>, data, &#123; <span class="attr">priority</span>: <span class="number">1</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Job với priority thấp</span></span><br><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;newsletter&#x27;</span>, data, &#123; <span class="attr">priority</span>: <span class="number">10</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Job bình thường</span></span><br><span class="line"><span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;regular-email&#x27;</span>, data); <span class="comment">// priority: 0</span></span><br></pre></td></tr></table></figure>

<h2 id="Concurrency"><a href="#Concurrency" class="headerlink" title="Concurrency"></a>Concurrency</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Worker với concurrency cao</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;email-queue&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="comment">// Xử lý job</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">concurrency</span>: <span class="number">10</span> <span class="comment">// Xử lý 10 job cùng lúc</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Worker với concurrency thấp cho job nặng</span></span><br><span class="line"><span class="keyword">const</span> heavyWorker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;video-processing&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="comment">// Xử lý video</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">concurrency</span>: <span class="number">2</span> <span class="comment">// Chỉ 2 job cùng lúc</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Monitoring"><a href="#Monitoring" class="headerlink" title="Monitoring"></a>Monitoring</h2><h3 id="Queue-Events"><a href="#Queue-Events" class="headerlink" title="Queue Events"></a>Queue Events</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Queue events</span></span><br><span class="line">queue.<span class="title function_">on</span>(<span class="string">&#x27;waiting&#x27;</span>, <span class="function">(<span class="params">job</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> is waiting`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">queue.<span class="title function_">on</span>(<span class="string">&#x27;active&#x27;</span>, <span class="function">(<span class="params">job</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> started processing`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">queue.<span class="title function_">on</span>(<span class="string">&#x27;completed&#x27;</span>, <span class="function">(<span class="params">job, result</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> completed with result:`</span>, result);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">queue.<span class="title function_">on</span>(<span class="string">&#x27;failed&#x27;</span>, <span class="function">(<span class="params">job, err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> failed:`</span>, err);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">queue.<span class="title function_">on</span>(<span class="string">&#x27;stalled&#x27;</span>, <span class="function">(<span class="params">job</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> stalled`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Queue-Metrics"><a href="#Queue-Metrics" class="headerlink" title="Queue Metrics"></a>Queue Metrics</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lấy thông tin queue</span></span><br><span class="line"><span class="keyword">const</span> jobCounts = <span class="keyword">await</span> queue.<span class="title function_">getJobCounts</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Job counts:&#x27;</span>, jobCounts);</span><br><span class="line"><span class="comment">// &#123; waiting: 5, active: 2, completed: 100, failed: 3, delayed: 1 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Lấy jobs theo trạng thái</span></span><br><span class="line"><span class="keyword">const</span> waitingJobs = <span class="keyword">await</span> queue.<span class="title function_">getWaiting</span>();</span><br><span class="line"><span class="keyword">const</span> failedJobs = <span class="keyword">await</span> queue.<span class="title function_">getFailed</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lấy job cụ thể</span></span><br><span class="line"><span class="keyword">const</span> job = <span class="keyword">await</span> queue.<span class="title function_">getJob</span>(jobId);</span><br><span class="line"><span class="keyword">if</span> (job) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Job state:&#x27;</span>, <span class="keyword">await</span> job.<span class="title function_">getState</span>());</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Job progress:&#x27;</span>, job.<span class="property">progress</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Job logs:&#x27;</span>, job.<span class="property">logs</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Advanced-Features"><a href="#Advanced-Features" class="headerlink" title="Advanced Features"></a>Advanced Features</h2><h3 id="Job-Dependencies"><a href="#Job-Dependencies" class="headerlink" title="Job Dependencies"></a>Job Dependencies</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Job phụ thuộc vào job khác</span></span><br><span class="line"><span class="keyword">const</span> parentJob = <span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;parent-job&#x27;</span>, &#123; <span class="attr">data</span>: <span class="string">&#x27;parent&#x27;</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> childJob = <span class="keyword">await</span> queue.<span class="title function_">add</span>(<span class="string">&#x27;child-job&#x27;</span>, &#123; <span class="attr">data</span>: <span class="string">&#x27;child&#x27;</span> &#125;, &#123;</span><br><span class="line">  <span class="attr">dependencies</span>: [parentJob.<span class="property">id</span>]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Job-Progress"><a href="#Job-Progress" class="headerlink" title="Job Progress"></a>Job Progress</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;video-processing&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> totalSteps = <span class="number">100</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; totalSteps; i++) &#123;</span><br><span class="line">    <span class="comment">// Xử lý từng bước</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">processVideoStep</span>(i);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Cập nhật progress</span></span><br><span class="line">    <span class="keyword">await</span> job.<span class="title function_">updateProgress</span>((i + <span class="number">1</span>) / totalSteps * <span class="number">100</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Theo dõi progress</span></span><br><span class="line">worker.<span class="title function_">on</span>(<span class="string">&#x27;progress&#x27;</span>, <span class="function">(<span class="params">job, progress</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Job <span class="subst">$&#123;job.id&#125;</span> progress: <span class="subst">$&#123;progress&#125;</span>%`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Job-Logs"><a href="#Job-Logs" class="headerlink" title="Job Logs"></a>Job Logs</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;data-processing&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="comment">// Log thông tin</span></span><br><span class="line">  <span class="keyword">await</span> job.<span class="title function_">log</span>(<span class="string">&#x27;Starting data processing&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Xử lý dữ liệu</span></span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">processData</span>(job.<span class="property">data</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">await</span> job.<span class="title function_">log</span>(<span class="string">`Processed <span class="subst">$&#123;result.count&#125;</span> records`</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Rate-Limiting"><a href="#Rate-Limiting" class="headerlink" title="Rate Limiting"></a>Rate Limiting</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;api-calls&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="comment">// Xử lý API call</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">concurrency</span>: <span class="number">1</span>, <span class="comment">// Chỉ 1 job cùng lúc</span></span><br><span class="line">  <span class="attr">limiter</span>: &#123;</span><br><span class="line">    <span class="attr">max</span>: <span class="number">10</span>,      <span class="comment">// Tối đa 10 job</span></span><br><span class="line">    <span class="attr">duration</span>: <span class="number">60000</span> <span class="comment">// Trong 1 phút</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h2><h3 id="1-Error-Handling"><a href="#1-Error-Handling" class="headerlink" title="1. Error Handling"></a>1. Error Handling</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;email-queue&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">sendEmail</span>(job.<span class="property">data</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="comment">// Log chi tiết</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Email sending failed:&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">jobId</span>: job.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">data</span>: job.<span class="property">data</span>,</span><br><span class="line">      <span class="attr">error</span>: error.<span class="property">message</span>,</span><br><span class="line">      <span class="attr">stack</span>: error.<span class="property">stack</span></span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Phân loại error</span></span><br><span class="line">    <span class="keyword">if</span> (error.<span class="property">code</span> === <span class="string">&#x27;INVALID_EMAIL&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// Không retry cho invalid email</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">throw</span> error; <span class="comment">// Retry cho các error khác</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-Resource-Management"><a href="#2-Resource-Management" class="headerlink" title="2. Resource Management"></a>2. Resource Management</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Đóng connections khi shutdown</span></span><br><span class="line">process.<span class="title function_">on</span>(<span class="string">&#x27;SIGTERM&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> worker.<span class="title function_">close</span>();</span><br><span class="line">  <span class="keyword">await</span> queue.<span class="title function_">close</span>();</span><br><span class="line">  process.<span class="title function_">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="3-Monitoring-va-Alerting"><a href="#3-Monitoring-va-Alerting" class="headerlink" title="3. Monitoring và Alerting"></a>3. Monitoring và Alerting</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Monitor failed jobs</span></span><br><span class="line">worker.<span class="title function_">on</span>(<span class="string">&#x27;failed&#x27;</span>, <span class="title function_">async</span> (job, err) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> failedCount = <span class="keyword">await</span> queue.<span class="title function_">getJobCounts</span>(<span class="string">&#x27;failed&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (failedCount.<span class="property">failed</span> &gt; <span class="number">100</span>) &#123;</span><br><span class="line">    <span class="comment">// Gửi alert</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">sendAlert</span>(<span class="string">`Too many failed jobs: <span class="subst">$&#123;failedCount.failed&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="4-Performance-Optimization"><a href="#4-Performance-Optimization" class="headerlink" title="4. Performance Optimization"></a>4. Performance Optimization</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Sử dụng batch processing</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;batch-processing&#x27;</span>, <span class="title function_">async</span> (jobs) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> results = [];</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> job <span class="keyword">of</span> jobs) &#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">processItem</span>(job.<span class="property">data</span>);</span><br><span class="line">    results.<span class="title function_">push</span>(result);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">concurrency</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">batch</span>: &#123;</span><br><span class="line">    <span class="attr">size</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">delay</span>: <span class="number">1000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Vi-du-thuc-te-Email-Service"><a href="#Vi-du-thuc-te-Email-Service" class="headerlink" title="Ví dụ thực tế: Email Service"></a>Ví dụ thực tế: Email Service</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Queue</span>, <span class="title class_">Worker</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;bullmq&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> nodemailer <span class="keyword">from</span> <span class="string">&#x27;nodemailer&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Email queue</span></span><br><span class="line"><span class="keyword">const</span> emailQueue = <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&#x27;email-queue&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Email worker</span></span><br><span class="line"><span class="keyword">const</span> emailWorker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;email-queue&#x27;</span>, <span class="title function_">async</span> (job) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; to, subject, body, type &#125; = job.<span class="property">data</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Xử lý theo loại email</span></span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;welcome&#x27;</span>:</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">sendWelcomeEmail</span>(to, subject, body);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;newsletter&#x27;</span>:</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">sendNewsletter</span>(to, subject, body);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;notification&#x27;</span>:</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">sendNotification</span>(to, subject, body);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Unknown email type: <span class="subst">$&#123;type&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">concurrency</span>: <span class="number">5</span>,</span><br><span class="line">  <span class="attr">attempts</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">backoff</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;exponential&#x27;</span>,</span><br><span class="line">    <span class="attr">delay</span>: <span class="number">2000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Thêm email jobs</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">queueEmail</span>(<span class="params">type, to, subject, body, options = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> emailQueue.<span class="title function_">add</span>(type, &#123;</span><br><span class="line">    to,</span><br><span class="line">    subject,</span><br><span class="line">    body,</span><br><span class="line">    type</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="attr">priority</span>: options.<span class="property">priority</span> || <span class="number">0</span>,</span><br><span class="line">    <span class="attr">delay</span>: options.<span class="property">delay</span> || <span class="number">0</span>,</span><br><span class="line">    <span class="attr">attempts</span>: options.<span class="property">attempts</span> || <span class="number">3</span>,</span><br><span class="line">    ...options</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sử dụng</span></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">queueEmail</span>(<span class="string">&#x27;welcome&#x27;</span>, <span class="string">&#x27;user@example.com&#x27;</span>, <span class="string">&#x27;Welcome!&#x27;</span>, <span class="string">&#x27;Welcome to our platform&#x27;</span>);</span><br><span class="line"><span class="keyword">await</span> <span class="title function_">queueEmail</span>(<span class="string">&#x27;newsletter&#x27;</span>, <span class="string">&#x27;user@example.com&#x27;</span>, <span class="string">&#x27;Newsletter&#x27;</span>, <span class="string">&#x27;Weekly updates&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">delay</span>: <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// Gửi sau 24h</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Ket-luan"><a href="#Ket-luan" class="headerlink" title="Kết luận"></a>Kết luận</h2><p>BullMQ cung cấp một giải pháp mạnh mẽ và linh hoạt cho việc xử lý job bất đồng bộ trong Node.js. Với các tính năng như retry, delay, priority, và monitoring, nó phù hợp cho các ứng dụng production cần xử lý job một cách đáng tin cậy.</p>
<p><strong>Tài liệu tham khảo:</strong></p>
<ul>
<li><a href="https://docs.bullmq.io/">BullMQ Documentation</a></li>
<li><a href="https://redis.io/documentation">Redis Documentation</a></li>
<li><a href="https://nodejs.org/docs/">Node.js Documentation</a></li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Vui lòng kích hoạt JavaScript để xem các bình luận.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/archives/">Trang chủ</a></li>
        
          <li><a href="/Zero-to-hero-Series-Overview/">Zero to Hero</a></li>
        
          <li><a href="/archives/">Bài viết</a></li>
        
          <li><a href="/about/">Giới thiệu</a></li>
        
          <li><a href="https://github.com/ph4n4n">Dự án</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-BullMQ"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: BullMQ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Muc-luc"><span class="toc-number">1.1.</span> <span class="toc-text">Mục lục</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gioi-thieu"><span class="toc-number">1.2.</span> <span class="toc-text">Giới thiệu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cai-dat"><span class="toc-number">1.3.</span> <span class="toc-text">Cài đặt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cau-truc-co-ban"><span class="toc-number">1.4.</span> <span class="toc-text">Cấu trúc cơ bản</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Producer-va-Consumer"><span class="toc-number">1.5.</span> <span class="toc-text">Producer và Consumer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Producer"><span class="toc-number">1.5.1.</span> <span class="toc-text">Producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Consumer"><span class="toc-number">1.5.2.</span> <span class="toc-text">Consumer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Job-Options"><span class="toc-number">1.6.</span> <span class="toc-text">Job Options</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Retry-va-Error-Handling"><span class="toc-number">1.7.</span> <span class="toc-text">Retry và Error Handling</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Delay-va-Scheduling"><span class="toc-number">1.8.</span> <span class="toc-text">Delay và Scheduling</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Priority"><span class="toc-number">1.9.</span> <span class="toc-text">Priority</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Concurrency"><span class="toc-number">1.10.</span> <span class="toc-text">Concurrency</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Monitoring"><span class="toc-number">1.11.</span> <span class="toc-text">Monitoring</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Queue-Events"><span class="toc-number">1.11.1.</span> <span class="toc-text">Queue Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Queue-Metrics"><span class="toc-number">1.11.2.</span> <span class="toc-text">Queue Metrics</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Advanced-Features"><span class="toc-number">1.12.</span> <span class="toc-text">Advanced Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Job-Dependencies"><span class="toc-number">1.12.1.</span> <span class="toc-text">Job Dependencies</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Job-Progress"><span class="toc-number">1.12.2.</span> <span class="toc-text">Job Progress</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Job-Logs"><span class="toc-number">1.12.3.</span> <span class="toc-text">Job Logs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rate-Limiting"><span class="toc-number">1.12.4.</span> <span class="toc-text">Rate Limiting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Best-Practices"><span class="toc-number">1.13.</span> <span class="toc-text">Best Practices</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Error-Handling"><span class="toc-number">1.13.1.</span> <span class="toc-text">1. Error Handling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Resource-Management"><span class="toc-number">1.13.2.</span> <span class="toc-text">2. Resource Management</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Monitoring-va-Alerting"><span class="toc-number">1.13.3.</span> <span class="toc-text">3. Monitoring và Alerting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Performance-Optimization"><span class="toc-number">1.13.4.</span> <span class="toc-text">4. Performance Optimization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vi-du-thuc-te-Email-Service"><span class="toc-number">1.14.</span> <span class="toc-text">Ví dụ thực tế: Email Service</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ket-luan"><span class="toc-number">1.15.</span> <span class="toc-text">Kết luận</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/Zero-to-hero-BullMQ/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&text=Zero to Hero: BullMQ"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&is_video=false&description=Zero to Hero: BullMQ"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: BullMQ&body=Check out this article: https://ph4n4n.github.io/Zero-to-hero-BullMQ/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&title=Zero to Hero: BullMQ"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&name=Zero to Hero: BullMQ&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/Zero-to-hero-BullMQ/&t=Zero to Hero: BullMQ"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Chia sẻ</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Về đầu trang</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Bản quyền &copy;
    
    
    2018-2025
    ph4n4n
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/archives/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/Zero-to-hero-Series-Overview/">Zero to Hero</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'https-ph4n4n-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->


<script>
(function() {
  var fallbackQuotes = [
    {q: 'Stay hungry, stay foolish.', a: 'Steve Jobs'},
    {q: 'Không có thành công nào mà không phải trả giá.', a: 'Ẩn danh'},
    {q: 'Simplicity is the soul of efficiency.', a: 'Austin Freeman'},
    {q: 'Hãy kiên trì, mọi thứ rồi sẽ ổn.', a: 'Ẩn danh'},
    {q: 'Code is like humor. When you have to explain it, it\'s bad.', a: 'Cory House'},
    {q: 'Chỉ cần bạn không dừng lại thì việc bạn tiến chậm cũng không là vấn đề.', a: 'Khổng Tử'},
    {q: 'The best way to get started is to quit talking and begin doing.', a: 'Walt Disney'},
    {q: 'Muốn đi nhanh thì đi một mình, muốn đi xa thì đi cùng nhau.', a: 'Tục ngữ'},
    {q: 'First, solve the problem. Then, write the code.', a: 'John Johnson'},
    {q: 'Đừng sợ thất bại, hãy sợ không thử.', a: 'Ẩn danh'},
    {q: 'No code no bug, no bug no life.', a: 'ph4n4n'},
    {q: 'No code no bug, no code no food.', a: 'ph4n4n'},
    {q: 'The only way to do great work is to love what you do.', a: 'Steve Jobs'},
    {q: 'Je suis món ennemi.', a: 'ph4n4n'},
    {q: 'Chết không phải lúc trái tim ngừng đập, chết là khi ý chí ngừng tiến lên.', a: 'ChatGPT'},
  ];
  var el = document.getElementById('random-quote');
  function showQuote(q, a) {
    if (el) el.innerHTML = q + (a ? ' <span style="font-size:0.95em;color:#888;">– ' + a + '</span>' : '');
  }
  function showFallback() {
    var r = fallbackQuotes[Math.floor(Math.random() * fallbackQuotes.length)];
    showQuote(r.q, r.a);
  }
  fetch('https://zenquotes.io/api/random')
    .then(function(res) { return res.ok ? res.json() : Promise.reject(); })
    .then(function(data) {
      if (Array.isArray(data) && data[0] && data[0].q) {
        showQuote(data[0].q, data[0].a);
      } else {
        showFallback();
      }
    })
    .catch(showFallback);
})();
</script>
</body>
</html>
