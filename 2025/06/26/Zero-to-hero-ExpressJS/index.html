<!DOCTYPE html>
<html lang=vi>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Zero to Hero: ExpressJS - Web Framework từ cơ bản đến nâng caoExpressJS là web framework phổ biến nhất cho Node.js, cung cấp các tính năng mạnh mẽ để xây dựng web applications và REST APIs một cách nh">
<meta property="og:type" content="article">
<meta property="og:title" content="Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao">
<meta property="og:url" content="https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/index.html">
<meta property="og:site_name" content="ph4n4n&#39;s code notes &amp; tips">
<meta property="og:description" content="Zero to Hero: ExpressJS - Web Framework từ cơ bản đến nâng caoExpressJS là web framework phổ biến nhất cho Node.js, cung cấp các tính năng mạnh mẽ để xây dựng web applications và REST APIs một cách nh">
<meta property="og:locale" content="vi_VN">
<meta property="article:published_time" content="2025-06-26T08:59:38.000Z">
<meta property="article:modified_time" content="2025-06-27T03:42:10.186Z">
<meta property="article:author" content="ph4n4n">
<meta property="article:tag" content="Database">
<meta property="article:tag" content="Node.js">
<meta property="article:tag" content="Authentication">
<meta property="article:tag" content="ExpressJS">
<meta property="article:tag" content="Web Framework">
<meta property="article:tag" content="REST API">
<meta property="article:tag" content="Middleware">
<meta property="article:tag" content="Routing">
<meta property="article:tag" content="Testing">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- Monaco font override -->
    
<link rel="stylesheet" href="/css/monaco-override.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="ph4n4n&#39;s code notes &amp; tips" type="application/atom+xml" />
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Bài trước" href="/2025/06/26/Zero-to-hero-CSS/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Bài tiếp theo" href="/2025/06/26/Zero-to-hero-Javascript/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Về đầu trang" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Chia sẻ bài viết" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Bài trước</span>
      <span id="i-next" class="info" style="display:none;">Bài tiếp theo</span>
      <span id="i-top" class="info" style="display:none;">Về đầu trang</span>
      <span id="i-share" class="info" style="display:none;">Chia sẻ bài viết</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&text=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&is_video=false&description=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao&body=Check out this article: https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&name=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&t=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-ExpressJS-Web-Framework-tu-co-ban-den-nang-cao"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: ExpressJS - Web Framework từ cơ bản đến nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Gioi-thieu-va-khai-niem-co-ban"><span class="toc-number">1.1.</span> <span class="toc-text">1. Giới thiệu và khái niệm cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ExpressJS-la-gi"><span class="toc-number">1.1.1.</span> <span class="toc-text">ExpressJS là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dac-diem-chinh"><span class="toc-number">1.1.2.</span> <span class="toc-text">Đặc điểm chính:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-cases-pho-bien"><span class="toc-number">1.1.3.</span> <span class="toc-text">Use cases phổ biến:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ExpressJS-vs-Other-Frameworks"><span class="toc-number">1.1.4.</span> <span class="toc-text">ExpressJS vs Other Frameworks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ExpressJS-Architecture"><span class="toc-number">1.1.5.</span> <span class="toc-text">ExpressJS Architecture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Core-Concepts"><span class="toc-number">1.1.6.</span> <span class="toc-text">Core Concepts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Cai-dat-va-setup-moi-truong"><span class="toc-number">1.2.</span> <span class="toc-text">2. Cài đặt và setup môi trường</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Project-Setup"><span class="toc-number">1.2.1.</span> <span class="toc-text">Project Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Project-Structure"><span class="toc-number">1.2.2.</span> <span class="toc-text">Basic Project Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Package-json-Configuration"><span class="toc-number">1.2.3.</span> <span class="toc-text">Package.json Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Environment-Configuration"><span class="toc-number">1.2.4.</span> <span class="toc-text">Environment Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ESLint-Configuration"><span class="toc-number">1.2.5.</span> <span class="toc-text">ESLint Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VS-Code-Extensions"><span class="toc-number">1.2.6.</span> <span class="toc-text">VS Code Extensions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Cu-phap-va-cau-truc-co-ban"><span class="toc-number">1.3.</span> <span class="toc-text">3. Cú pháp và cấu trúc cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Express-App"><span class="toc-number">1.3.1.</span> <span class="toc-text">Basic Express App</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Methods"><span class="toc-number">1.3.2.</span> <span class="toc-text">HTTP Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Route-Parameters"><span class="toc-number">1.3.3.</span> <span class="toc-text">Route Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-Parameters"><span class="toc-number">1.3.4.</span> <span class="toc-text">Query Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Request-Body"><span class="toc-number">1.3.5.</span> <span class="toc-text">Request Body</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Response-Methods"><span class="toc-number">1.3.6.</span> <span class="toc-text">Response Methods</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Cac-tinh-nang-nang-cao"><span class="toc-number">1.4.</span> <span class="toc-text">4. Các tính năng nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Middleware"><span class="toc-number">1.4.1.</span> <span class="toc-text">Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Router"><span class="toc-number">1.4.2.</span> <span class="toc-text">Router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error-Handling"><span class="toc-number">1.4.3.</span> <span class="toc-text">Error Handling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-Authorization"><span class="toc-number">1.4.4.</span> <span class="toc-text">Authentication &amp; Authorization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-Upload"><span class="toc-number">1.4.5.</span> <span class="toc-text">File Upload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-Integration"><span class="toc-number">1.4.6.</span> <span class="toc-text">Database Integration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Validation"><span class="toc-number">1.4.7.</span> <span class="toc-text">Validation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Best-practices-va-patterns"><span class="toc-number">1.5.</span> <span class="toc-text">5. Best practices và patterns</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Project-Structure"><span class="toc-number">1.5.1.</span> <span class="toc-text">Project Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security-Best-Practices"><span class="toc-number">1.5.2.</span> <span class="toc-text">Security Best Practices</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance-Optimization"><span class="toc-number">1.5.3.</span> <span class="toc-text">Performance Optimization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Logging"><span class="toc-number">1.5.4.</span> <span class="toc-text">Logging</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Vi-du-thuc-te"><span class="toc-number">1.6.</span> <span class="toc-text">6. Ví dụ thực tế</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#REST-API-Example"><span class="toc-number">1.6.1.</span> <span class="toc-text">REST API Example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-System"><span class="toc-number">1.6.2.</span> <span class="toc-text">Authentication System</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRUD-Operations"><span class="toc-number">1.6.3.</span> <span class="toc-text">CRUD Operations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-Upload-System"><span class="toc-number">1.6.4.</span> <span class="toc-text">File Upload System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Troubleshooting-va-tips"><span class="toc-number">1.7.</span> <span class="toc-text">7. Troubleshooting và tips</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Common-Issues"><span class="toc-number">1.7.1.</span> <span class="toc-text">Common Issues</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-CORS-Errors"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">1. CORS Errors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Body-Parser-Issues"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">2. Body Parser Issues</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Async-Await-Error-Handling"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">3. Async&#x2F;Await Error Handling</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Static-Files-Not-Serving"><span class="toc-number">1.7.1.4.</span> <span class="toc-text">4. Static Files Not Serving</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Session-Issues"><span class="toc-number">1.7.1.5.</span> <span class="toc-text">5. Session Issues</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Debugging-Tips"><span class="toc-number">1.7.2.</span> <span class="toc-text">Debugging Tips</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Request-Logging"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">1. Request Logging</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Error-Tracking"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">2. Error Tracking</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Performance-Monitoring"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">3. Performance Monitoring</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Memory-Leaks"><span class="toc-number">1.7.2.4.</span> <span class="toc-text">4. Memory Leaks</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Tai-lieu-tham-khao"><span class="toc-number">1.8.</span> <span class="toc-text">8. Tài liệu tham khảo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Official-Documentation"><span class="toc-number">1.8.1.</span> <span class="toc-text">Official Documentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Learning-Resources"><span class="toc-number">1.8.2.</span> <span class="toc-text">Learning Resources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tools-Middleware"><span class="toc-number">1.8.3.</span> <span class="toc-text">Tools &amp; Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Testing"><span class="toc-number">1.8.4.</span> <span class="toc-text">Testing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-Integration-1"><span class="toc-number">1.8.5.</span> <span class="toc-text">Database Integration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-Security"><span class="toc-number">1.8.6.</span> <span class="toc-text">Authentication &amp; Security</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ph4n4n</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-06-26T08:59:38.000Z" class="dt-published" itemprop="datePublished">2025-06-26</time>
        
        (Updated: <time datetime="2025-06-27T03:42:10.186Z" class="dt-updated" itemprop="dateModified">2025-06-27</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Backend/">Backend</a> › <a class="category-link" href="/categories/Backend/Node-js/">Node.js</a> › <a class="category-link" href="/categories/Backend/Node-js/Web-Development/">Web Development</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Authentication/" rel="tag">Authentication</a>, <a class="p-category" href="/tags/Database/" rel="tag">Database</a>, <a class="p-category" href="/tags/ExpressJS/" rel="tag">ExpressJS</a>, <a class="p-category" href="/tags/Middleware/" rel="tag">Middleware</a>, <a class="p-category" href="/tags/Node-js/" rel="tag">Node.js</a>, <a class="p-category" href="/tags/REST-API/" rel="tag">REST API</a>, <a class="p-category" href="/tags/Routing/" rel="tag">Routing</a>, <a class="p-category" href="/tags/Testing/" rel="tag">Testing</a>, <a class="p-category" href="/tags/Web-Framework/" rel="tag">Web Framework</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Zero-to-Hero-ExpressJS-Web-Framework-tu-co-ban-den-nang-cao"><a href="#Zero-to-Hero-ExpressJS-Web-Framework-tu-co-ban-den-nang-cao" class="headerlink" title="Zero to Hero: ExpressJS - Web Framework từ cơ bản đến nâng cao"></a>Zero to Hero: ExpressJS - Web Framework từ cơ bản đến nâng cao</h1><p>ExpressJS là web framework phổ biến nhất cho Node.js, cung cấp các tính năng mạnh mẽ để xây dựng web applications và REST APIs một cách nhanh chóng và hiệu quả.</p>
<h2 id="1-Gioi-thieu-va-khai-niem-co-ban"><a href="#1-Gioi-thieu-va-khai-niem-co-ban" class="headerlink" title="1. Giới thiệu và khái niệm cơ bản"></a>1. Giới thiệu và khái niệm cơ bản</h2><h3 id="ExpressJS-la-gi"><a href="#ExpressJS-la-gi" class="headerlink" title="ExpressJS là gì?"></a>ExpressJS là gì?</h3><p>ExpressJS là một web application framework cho Node.js, cung cấp các tính năng robust để xây dựng single-page, multi-page và hybrid web applications. Nó được thiết kế để tạo ra web applications và APIs một cách nhanh chóng.</p>
<h3 id="Dac-diem-chinh"><a href="#Dac-diem-chinh" class="headerlink" title="Đặc điểm chính:"></a>Đặc điểm chính:</h3><ul>
<li><strong>Minimalist</strong>: Framework nhẹ và linh hoạt</li>
<li><strong>Unopinionated</strong>: Không áp đặt kiến trúc cụ thể</li>
<li><strong>Fast</strong>: Hiệu suất cao và ổn định</li>
<li><strong>Extensible</strong>: Dễ dàng mở rộng với middleware</li>
<li><strong>Routing</strong>: Hệ thống routing mạnh mẽ</li>
<li><strong>Middleware</strong>: Kiến trúc middleware linh hoạt</li>
<li><strong>Template Engines</strong>: Hỗ trợ nhiều template engines</li>
<li><strong>Static Files</strong>: Phục vụ static files dễ dàng</li>
</ul>
<h3 id="Use-cases-pho-bien"><a href="#Use-cases-pho-bien" class="headerlink" title="Use cases phổ biến:"></a>Use cases phổ biến:</h3><ul>
<li><strong>REST APIs</strong>: Xây dựng RESTful APIs</li>
<li><strong>Web Applications</strong>: Single-page và multi-page apps</li>
<li><strong>Microservices</strong>: Backend services nhỏ</li>
<li><strong>Real-time Apps</strong>: WebSocket và real-time features</li>
<li><strong>Mobile Backend</strong>: API cho mobile apps</li>
<li><strong>Proxy Server</strong>: Reverse proxy và load balancer</li>
<li><strong>File Upload</strong>: Handle file uploads</li>
<li><strong>Authentication</strong>: User authentication và authorization</li>
</ul>
<h3 id="ExpressJS-vs-Other-Frameworks"><a href="#ExpressJS-vs-Other-Frameworks" class="headerlink" title="ExpressJS vs Other Frameworks"></a>ExpressJS vs Other Frameworks</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ExpressJS - Minimalist</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(users);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// vs Koa - More modern</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">async</span> (ctx) =&gt; &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = users;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// vs Fastify - Performance focused</span></span><br><span class="line">fastify.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="title function_">async</span> (request, reply) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> users;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="ExpressJS-Architecture"><a href="#ExpressJS-Architecture" class="headerlink" title="ExpressJS Architecture"></a>ExpressJS Architecture</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Request Flow</span></span><br><span class="line"><span class="title class_">Client</span> <span class="title class_">Request</span> → <span class="title class_">Express</span> <span class="title class_">App</span> → <span class="title class_">Middleware</span> <span class="title class_">Stack</span> → <span class="title class_">Route</span> <span class="title class_">Handler</span> → <span class="title class_">Response</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware Stack</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">morgan</span>(<span class="string">&#x27;combined&#x27;</span>));        <span class="comment">// Logging</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());            <span class="comment">// Body parsing</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>));  <span class="comment">// Static files</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, apiRouter);         <span class="comment">// API routes</span></span><br><span class="line">app.<span class="title function_">use</span>(errorHandler);              <span class="comment">// Error handling</span></span><br></pre></td></tr></table></figure>

<h3 id="Core-Concepts"><a href="#Core-Concepts" class="headerlink" title="Core Concepts"></a>Core Concepts</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Application</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;req.method&#125;</span> <span class="subst">$&#123;req.url&#125;</span>`</span>);</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Routes</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start server</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server running on port 3000&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="2-Cai-dat-va-setup-moi-truong"><a href="#2-Cai-dat-va-setup-moi-truong" class="headerlink" title="2. Cài đặt và setup môi trường"></a>2. Cài đặt và setup môi trường</h2><h3 id="Project-Setup"><a href="#Project-Setup" class="headerlink" title="Project Setup"></a>Project Setup</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create project directory</span></span><br><span class="line"><span class="built_in">mkdir</span> express-app</span><br><span class="line"><span class="built_in">cd</span> express-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize npm</span></span><br><span class="line">npm init -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install Express</span></span><br><span class="line">npm install express</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install development dependencies</span></span><br><span class="line">npm install --save-dev nodemon eslint prettier</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install additional packages</span></span><br><span class="line">npm install cors helmet morgan dotenv</span><br><span class="line">npm install express-rate-limit express-validator</span><br><span class="line">npm install jsonwebtoken bcryptjs</span><br><span class="line">npm install mongoose sequelize prisma</span><br><span class="line">npm install jest supertest</span><br></pre></td></tr></table></figure>

<h3 id="Basic-Project-Structure"><a href="#Basic-Project-Structure" class="headerlink" title="Basic Project Structure"></a>Basic Project Structure</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">express-app/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── controllers/</span><br><span class="line">│   │   ├── userController.js</span><br><span class="line">│   │   └── authController.js</span><br><span class="line">│   ├── middleware/</span><br><span class="line">│   │   ├── auth.js</span><br><span class="line">│   │   ├── validation.js</span><br><span class="line">│   │   └── errorHandler.js</span><br><span class="line">│   ├── models/</span><br><span class="line">│   │   ├── User.js</span><br><span class="line">│   │   └── Product.js</span><br><span class="line">│   ├── routes/</span><br><span class="line">│   │   ├── userRoutes.js</span><br><span class="line">│   │   ├── authRoutes.js</span><br><span class="line">│   │   └── apiRoutes.js</span><br><span class="line">│   ├── config/</span><br><span class="line">│   │   ├── database.js</span><br><span class="line">│   │   └── passport.js</span><br><span class="line">│   ├── utils/</span><br><span class="line">│   │   ├── logger.js</span><br><span class="line">│   │   └── helpers.js</span><br><span class="line">│   └── app.js</span><br><span class="line">├── tests/</span><br><span class="line">│   ├── integration/</span><br><span class="line">│   └── unit/</span><br><span class="line">├── public/</span><br><span class="line">│   ├── css/</span><br><span class="line">│   ├── js/</span><br><span class="line">│   └── images/</span><br><span class="line">├── views/</span><br><span class="line">├── .env</span><br><span class="line">├── .gitignore</span><br><span class="line">├── package.json</span><br><span class="line">└── README.md</span><br></pre></td></tr></table></figure>

<h3 id="Package-json-Configuration"><a href="#Package-json-Configuration" class="headerlink" title="Package.json Configuration"></a>Package.json Configuration</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;express-app&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ExpressJS application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;src/app.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node src/app.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nodemon src/app.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jest&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test:watch&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jest --watch&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eslint src/&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lint:fix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eslint src/ --fix&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;format&quot;</span><span class="punctuation">:</span> <span class="string">&quot;prettier --write src/&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;express&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nodejs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;api&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Your Name&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;express&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.18.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cors&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.8.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;helmet&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;morgan&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.10.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dotenv&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^16.0.3&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;nodemon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eslint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^8.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jest&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^29.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;supertest&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.3.3&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Environment-Configuration"><a href="#Environment-Configuration" class="headerlink" title="Environment Configuration"></a>Environment Configuration</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env</span></span><br><span class="line">NODE_ENV=development</span><br><span class="line">PORT=3000</span><br><span class="line">MONGODB_URI=mongodb://localhost:27017/myapp</span><br><span class="line">JWT_SECRET=your-secret-key</span><br><span class="line">JWT_EXPIRES_IN=7d</span><br><span class="line">BCRYPT_ROUNDS=12</span><br><span class="line">CORS_ORIGIN=http://localhost:3000</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config/config.js</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;dotenv&#x27;</span>).<span class="title function_">config</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">env</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> || <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  <span class="attr">port</span>: process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>,</span><br><span class="line">  <span class="attr">mongoUri</span>: process.<span class="property">env</span>.<span class="property">MONGODB_URI</span>,</span><br><span class="line">  <span class="attr">jwtSecret</span>: process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">  <span class="attr">jwtExpiresIn</span>: process.<span class="property">env</span>.<span class="property">JWT_EXPIRES_IN</span> || <span class="string">&#x27;7d&#x27;</span>,</span><br><span class="line">  <span class="attr">bcryptRounds</span>: <span class="built_in">parseInt</span>(process.<span class="property">env</span>.<span class="property">BCRYPT_ROUNDS</span>) || <span class="number">12</span>,</span><br><span class="line">  <span class="attr">corsOrigin</span>: process.<span class="property">env</span>.<span class="property">CORS_ORIGIN</span> || <span class="string">&#x27;http://localhost:3000&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ESLint-Configuration"><a href="#ESLint-Configuration" class="headerlink" title="ESLint Configuration"></a>ESLint Configuration</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;node&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;es2021&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jest&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;eslint:recommended&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;parserOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ecmaVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latest&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sourceType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;rules&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;indent&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;error&quot;</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;linebreak-style&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;error&quot;</span><span class="punctuation">,</span> <span class="string">&quot;unix&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;quotes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;error&quot;</span><span class="punctuation">,</span> <span class="string">&quot;single&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;semi&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;error&quot;</span><span class="punctuation">,</span> <span class="string">&quot;always&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;no-unused-vars&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;error&quot;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;argsIgnorePattern&quot;</span><span class="punctuation">:</span> <span class="string">&quot;next&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="VS-Code-Extensions"><a href="#VS-Code-Extensions" class="headerlink" title="VS Code Extensions"></a>VS Code Extensions</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;recommendations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;ms-vscode.vscode-typescript-next&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;esbenp.prettier-vscode&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;ms-vscode.vscode-eslint&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;bradlc.vscode-tailwindcss&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;formulahendry.auto-rename-tag&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;christian-kohler.path-intellisense&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-Cu-phap-va-cau-truc-co-ban"><a href="#3-Cu-phap-va-cau-truc-co-ban" class="headerlink" title="3. Cú pháp và cấu trúc cơ bản"></a>3. Cú pháp và cấu trúc cơ bản</h2><h3 id="Basic-Express-App"><a href="#Basic-Express-App" class="headerlink" title="Basic Express App"></a>Basic Express App</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Routes</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">users</span>: [] &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Error handling</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err.<span class="property">stack</span>);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Something broke!&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start server</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>;</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running on port <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="HTTP-Methods"><a href="#HTTP-Methods" class="headerlink" title="HTTP Methods"></a>HTTP Methods</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GET - Retrieve data</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(users);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST - Create data</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> newUser = req.<span class="property">body</span>;</span><br><span class="line">  users.<span class="title function_">push</span>(newUser);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(newUser);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// PUT - Update entire resource</span></span><br><span class="line">app.<span class="title function_">put</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="keyword">const</span> updateData = req.<span class="property">body</span>;</span><br><span class="line">  <span class="comment">// Update logic</span></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;User updated&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// PATCH - Partial update</span></span><br><span class="line">app.<span class="title function_">patch</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="keyword">const</span> updateData = req.<span class="property">body</span>;</span><br><span class="line">  <span class="comment">// Partial update logic</span></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;User partially updated&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// DELETE - Remove data</span></span><br><span class="line">app.<span class="title function_">delete</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="comment">// Delete logic</span></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;User deleted&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Route-Parameters"><a href="#Route-Parameters" class="headerlink" title="Route Parameters"></a>Route Parameters</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Single parameter</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Multiple parameters</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:userId/posts/:postId&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; userId, postId &#125; = req.<span class="property">params</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; userId, postId &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Optional parameters</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id?&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="keyword">if</span> (id) &#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;All users&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Regex parameters</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id([0-9]+)&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Query-Parameters"><a href="#Query-Parameters" class="headerlink" title="Query Parameters"></a>Query Parameters</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GET /users?page=1&amp;limit=10&amp;sort=name</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; page = <span class="number">1</span>, limit = <span class="number">10</span>, sort = <span class="string">&#x27;name&#x27;</span> &#125; = req.<span class="property">query</span>;</span><br><span class="line">  </span><br><span class="line">  res.<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">page</span>: <span class="built_in">parseInt</span>(page),</span><br><span class="line">    <span class="attr">limit</span>: <span class="built_in">parseInt</span>(limit),</span><br><span class="line">    sort,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;Users retrieved&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Complex query handling</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/search&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; q, category, price_min, price_max &#125; = req.<span class="property">query</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> searchParams = &#123;</span><br><span class="line">    <span class="attr">query</span>: q,</span><br><span class="line">    <span class="attr">category</span>: category ? category.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>) : [],</span><br><span class="line">    <span class="attr">priceRange</span>: &#123;</span><br><span class="line">      <span class="attr">min</span>: <span class="built_in">parseFloat</span>(price_min) || <span class="number">0</span>,</span><br><span class="line">      <span class="attr">max</span>: <span class="built_in">parseFloat</span>(price_max) || <span class="title class_">Infinity</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  res.<span class="title function_">json</span>(searchParams);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Request-Body"><a href="#Request-Body" class="headerlink" title="Request Body"></a>Request Body</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JSON body</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; name, email, age &#125; = req.<span class="property">body</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (!name || !email) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Name and email required&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> newUser = &#123; name, email, age &#125;;</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(newUser);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Form data</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; title, description &#125; = req.<span class="property">body</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; title, description &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Raw body</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/webhook&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> rawBody = req.<span class="property">body</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Webhook received:&#x27;</span>, rawBody);</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">received</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Response-Methods"><a href="#Response-Methods" class="headerlink" title="Response Methods"></a>Response Methods</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JSON response</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/data&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;Success&#x27;</span>, <span class="attr">data</span>: [] &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Status codes</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Create user logic</span></span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;User created&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">put</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Update logic</span></span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;User updated&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">delete</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Delete logic</span></span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">204</span>).<span class="title function_">send</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Redirect</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/old-page&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">redirect</span>(<span class="string">&#x27;/new-page&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Download file</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/download&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">download</span>(<span class="string">&#x27;./files/document.pdf&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Send file</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/file&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">sendFile</span>(<span class="string">&#x27;./files/image.jpg&#x27;</span>, &#123; <span class="attr">root</span>: __dirname &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="4-Cac-tinh-nang-nang-cao"><a href="#4-Cac-tinh-nang-nang-cao" class="headerlink" title="4. Các tính năng nâng cao"></a>4. Các tính năng nâng cao</h2><h3 id="Middleware"><a href="#Middleware" class="headerlink" title="Middleware"></a>Middleware</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Custom middleware</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">logger</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toISOString()&#125;</span> - <span class="subst">$&#123;req.method&#125;</span> <span class="subst">$&#123;req.url&#125;</span>`</span>);</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">auth</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> token = req.<span class="property">headers</span>.<span class="property">authorization</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;No token provided&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> decoded = jwt.<span class="title function_">verify</span>(token, process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>);</span><br><span class="line">    req.<span class="property">user</span> = decoded;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid token&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apply middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(logger);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, auth);</span><br></pre></td></tr></table></figure>

<h3 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// userRoutes.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">const</span> userController = <span class="built_in">require</span>(<span class="string">&#x27;../controllers/userController&#x27;</span>);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, userController.<span class="property">getAllUsers</span>);</span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/:id&#x27;</span>, userController.<span class="property">getUserById</span>);</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, userController.<span class="property">createUser</span>);</span><br><span class="line">router.<span class="title function_">put</span>(<span class="string">&#x27;/:id&#x27;</span>, userController.<span class="property">updateUser</span>);</span><br><span class="line">router.<span class="title function_">delete</span>(<span class="string">&#x27;/:id&#x27;</span>, userController.<span class="property">deleteUser</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> userRoutes = <span class="built_in">require</span>(<span class="string">&#x27;./routes/userRoutes&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/users&#x27;</span>, userRoutes);</span><br></pre></td></tr></table></figure>

<h3 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Custom error class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AppError</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Error</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">message, statusCode</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(message);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">statusCode</span> = statusCode;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">`<span class="subst">$&#123;statusCode&#125;</span>`</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;4&#x27;</span>) ? <span class="string">&#x27;fail&#x27;</span> : <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isOperational</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Error</span>.<span class="title function_">captureStackTrace</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">constructor</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Async error handler</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">catchAsync</span> = (<span class="params">fn</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="title function_">fn</span>(req, res, next)).<span class="title function_">catch</span>(next);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Global error handler</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">errorHandler</span> = (<span class="params">err, req, res, next</span>) =&gt; &#123;</span><br><span class="line">  err.<span class="property">statusCode</span> = err.<span class="property">statusCode</span> || <span class="number">500</span>;</span><br><span class="line">  err.<span class="property">status</span> = err.<span class="property">status</span> || <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span>) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(err.<span class="property">statusCode</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">      <span class="attr">status</span>: err.<span class="property">status</span>,</span><br><span class="line">      <span class="attr">error</span>: err,</span><br><span class="line">      <span class="attr">message</span>: err.<span class="property">message</span>,</span><br><span class="line">      <span class="attr">stack</span>: err.<span class="property">stack</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(err.<span class="property">statusCode</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">      <span class="attr">status</span>: err.<span class="property">status</span>,</span><br><span class="line">      <span class="attr">message</span>: err.<span class="property">message</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="title function_">catchAsync</span>(<span class="title function_">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findById</span>(req.<span class="property">params</span>.<span class="property">id</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>(<span class="keyword">new</span> <span class="title class_">AppError</span>(<span class="string">&#x27;User not found&#x27;</span>, <span class="number">404</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  res.<span class="title function_">json</span>(user);</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(errorHandler);</span><br></pre></td></tr></table></figure>

<h3 id="Authentication-Authorization"><a href="#Authentication-Authorization" class="headerlink" title="Authentication &amp; Authorization"></a>Authentication &amp; Authorization</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JWT Authentication</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = <span class="built_in">require</span>(<span class="string">&#x27;../models/User&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> authController = &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">register</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; name, email, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Check if user exists</span></span><br><span class="line">      <span class="keyword">const</span> existingUser = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123; email &#125;);</span><br><span class="line">      <span class="keyword">if</span> (existingUser) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Email already registered&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Hash password</span></span><br><span class="line">      <span class="keyword">const</span> hashedPassword = <span class="keyword">await</span> bcrypt.<span class="title function_">hash</span>(password, <span class="number">12</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Create user</span></span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        name,</span><br><span class="line">        email,</span><br><span class="line">        <span class="attr">password</span>: hashedPassword</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Generate token</span></span><br><span class="line">      <span class="keyword">const</span> token = jwt.<span class="title function_">sign</span>(</span><br><span class="line">        &#123; <span class="attr">userId</span>: user.<span class="property">_id</span> &#125;,</span><br><span class="line">        process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">        &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;7d&#x27;</span> &#125;</span><br><span class="line">      );</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;User registered successfully&#x27;</span>,</span><br><span class="line">        token,</span><br><span class="line">        <span class="attr">user</span>: &#123;</span><br><span class="line">          <span class="attr">id</span>: user.<span class="property">_id</span>,</span><br><span class="line">          <span class="attr">name</span>: user.<span class="property">name</span>,</span><br><span class="line">          <span class="attr">email</span>: user.<span class="property">email</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Registration failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; email, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Find user</span></span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123; email &#125;);</span><br><span class="line">      <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid credentials&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Check password</span></span><br><span class="line">      <span class="keyword">const</span> isValidPassword = <span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(password, user.<span class="property">password</span>);</span><br><span class="line">      <span class="keyword">if</span> (!isValidPassword) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid credentials&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Generate token</span></span><br><span class="line">      <span class="keyword">const</span> token = jwt.<span class="title function_">sign</span>(</span><br><span class="line">        &#123; <span class="attr">userId</span>: user.<span class="property">_id</span> &#125;,</span><br><span class="line">        process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">        &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;7d&#x27;</span> &#125;</span><br><span class="line">      );</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Login successful&#x27;</span>,</span><br><span class="line">        token,</span><br><span class="line">        <span class="attr">user</span>: &#123;</span><br><span class="line">          <span class="attr">id</span>: user.<span class="property">_id</span>,</span><br><span class="line">          <span class="attr">name</span>: user.<span class="property">name</span>,</span><br><span class="line">          <span class="attr">email</span>: user.<span class="property">email</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Login failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = authController;</span><br></pre></td></tr></table></figure>

<h3 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&#x27;multer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure multer</span></span><br><span class="line"><span class="keyword">const</span> storage = multer.<span class="title function_">diskStorage</span>(&#123;</span><br><span class="line">  <span class="attr">destination</span>: <span class="title function_">async</span> (req, file, cb) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> uploadDir = <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> fs.<span class="title function_">mkdir</span>(uploadDir, &#123; <span class="attr">recursive</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">      <span class="title function_">cb</span>(<span class="literal">null</span>, uploadDir);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="title function_">cb</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">filename</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>() + path.<span class="title function_">extname</span>(file.<span class="property">originalname</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123;</span><br><span class="line">  storage,</span><br><span class="line">  <span class="attr">limits</span>: &#123;</span><br><span class="line">    <span class="attr">fileSize</span>: <span class="number">5</span> * <span class="number">1024</span> * <span class="number">1024</span> <span class="comment">// 5MB</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">fileFilter</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> allowedTypes = <span class="regexp">/jpeg|jpg|png|gif|pdf|doc|docx/</span>;</span><br><span class="line">    <span class="keyword">const</span> extname = allowedTypes.<span class="title function_">test</span>(path.<span class="title function_">extname</span>(file.<span class="property">originalname</span>).<span class="title function_">toLowerCase</span>());</span><br><span class="line">    <span class="keyword">const</span> mimetype = allowedTypes.<span class="title function_">test</span>(file.<span class="property">mimetype</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (mimetype &amp;&amp; extname) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Invalid file type&#x27;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> uploadController = &#123;</span><br><span class="line">  <span class="comment">// Single file upload</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">uploadFile</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!req.<span class="property">file</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;No file uploaded&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">        <span class="attr">filename</span>: req.<span class="property">file</span>.<span class="property">filename</span>,</span><br><span class="line">        <span class="attr">originalName</span>: req.<span class="property">file</span>.<span class="property">originalname</span>,</span><br><span class="line">        <span class="attr">size</span>: req.<span class="property">file</span>.<span class="property">size</span>,</span><br><span class="line">        <span class="attr">mimetype</span>: req.<span class="property">file</span>.<span class="property">mimetype</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Upload failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Multiple files upload</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">uploadMultipleFiles</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!req.<span class="property">files</span> || req.<span class="property">files</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;No files uploaded&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> files = req.<span class="property">files</span>.<span class="title function_">map</span>(<span class="function"><span class="params">file</span> =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">filename</span>: file.<span class="property">filename</span>,</span><br><span class="line">        <span class="attr">originalName</span>: file.<span class="property">originalname</span>,</span><br><span class="line">        <span class="attr">size</span>: file.<span class="property">size</span>,</span><br><span class="line">        <span class="attr">mimetype</span>: file.<span class="property">mimetype</span></span><br><span class="line">      &#125;));</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Files uploaded successfully&#x27;</span>,</span><br><span class="line">        files</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Upload failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; upload, uploadController &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Database-Integration"><a href="#Database-Integration" class="headerlink" title="Database Integration"></a>Database Integration</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MongoDB with Mongoose</span></span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Connect to MongoDB</span></span><br><span class="line">mongoose.<span class="title function_">connect</span>(process.<span class="property">env</span>.<span class="property">MONGODB_URI</span>, &#123;</span><br><span class="line">  <span class="attr">useNewUrlParser</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">useUnifiedTopology</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// User Model</span></span><br><span class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">email</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">unique</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">password</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">role</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">enum</span>: [<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>], <span class="attr">default</span>: <span class="string">&#x27;user&#x27;</span> &#125;</span><br><span class="line">&#125;, &#123; <span class="attr">timestamps</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = mongoose.<span class="title function_">model</span>(<span class="string">&#x27;User&#x27;</span>, userSchema);</span><br><span class="line"></span><br><span class="line"><span class="comment">// User Controller</span></span><br><span class="line"><span class="keyword">const</span> userController = &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getAllUsers</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> users = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">find</span>().<span class="title function_">select</span>(<span class="string">&#x27;-password&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">json</span>(users);</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUserById</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findById</span>(req.<span class="property">params</span>.<span class="property">id</span>).<span class="title function_">select</span>(<span class="string">&#x27;-password&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;User not found&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    res.<span class="title function_">json</span>(user);</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">createUser</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name, email, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> hashedPassword = <span class="keyword">await</span> bcrypt.<span class="title function_">hash</span>(password, <span class="number">12</span>);</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">create</span>(&#123; name, email, <span class="attr">password</span>: hashedPassword &#125;);</span><br><span class="line">    </span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123; <span class="attr">id</span>: user.<span class="property">_id</span>, <span class="attr">name</span>: user.<span class="property">name</span>, <span class="attr">email</span>: user.<span class="property">email</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Validation"><a href="#Validation" class="headerlink" title="Validation"></a>Validation</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; body, validationResult &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-validator&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Validation middleware</span></span><br><span class="line"><span class="keyword">const</span> validateUser = [</span><br><span class="line">  <span class="title function_">body</span>(<span class="string">&#x27;name&#x27;</span>).<span class="title function_">trim</span>().<span class="title function_">isLength</span>(&#123; <span class="attr">min</span>: <span class="number">2</span> &#125;).<span class="title function_">withMessage</span>(<span class="string">&#x27;Name must be at least 2 characters&#x27;</span>),</span><br><span class="line">  <span class="title function_">body</span>(<span class="string">&#x27;email&#x27;</span>).<span class="title function_">isEmail</span>().<span class="title function_">normalizeEmail</span>().<span class="title function_">withMessage</span>(<span class="string">&#x27;Valid email required&#x27;</span>),</span><br><span class="line">  <span class="title function_">body</span>(<span class="string">&#x27;password&#x27;</span>).<span class="title function_">isLength</span>(&#123; <span class="attr">min</span>: <span class="number">6</span> &#125;).<span class="title function_">withMessage</span>(<span class="string">&#x27;Password must be at least 6 characters&#x27;</span>),</span><br><span class="line">  <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> errors = <span class="title function_">validationResult</span>(req);</span><br><span class="line">    <span class="keyword">if</span> (!errors.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">errors</span>: errors.<span class="title function_">array</span>() &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, validateUser, userController.<span class="property">createUser</span>);</span><br></pre></td></tr></table></figure>

<h2 id="5-Best-practices-va-patterns"><a href="#5-Best-practices-va-patterns" class="headerlink" title="5. Best practices và patterns"></a>5. Best practices và patterns</h2><h3 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a>Project Structure</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MVC Pattern</span></span><br><span class="line"><span class="comment">// Model - Data and business logic</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">findById</span>(<span class="params">id</span>) &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">create</span>(<span class="params">data</span>) &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// View - Response formatting</span></span><br><span class="line"><span class="keyword">const</span> userView = &#123;</span><br><span class="line">  <span class="title function_">format</span>(<span class="params">user</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">id</span>: user.<span class="property">_id</span>,</span><br><span class="line">      <span class="attr">name</span>: user.<span class="property">name</span>,</span><br><span class="line">      <span class="attr">email</span>: user.<span class="property">email</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Controller - Request handling</span></span><br><span class="line"><span class="keyword">const</span> userController = &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUser</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findById</span>(req.<span class="property">params</span>.<span class="property">id</span>);</span><br><span class="line">    res.<span class="title function_">json</span>(userView.<span class="title function_">format</span>(user));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Security-Best-Practices"><a href="#Security-Best-Practices" class="headerlink" title="Security Best Practices"></a>Security Best Practices</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> helmet = <span class="built_in">require</span>(<span class="string">&#x27;helmet&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> rateLimit = <span class="built_in">require</span>(<span class="string">&#x27;express-rate-limit&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Security middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">helmet</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rate limiting</span></span><br><span class="line"><span class="keyword">const</span> limiter = <span class="title function_">rateLimit</span>(&#123;</span><br><span class="line">  <span class="attr">windowMs</span>: <span class="number">15</span> * <span class="number">60</span> * <span class="number">1000</span>, <span class="comment">// 15 minutes</span></span><br><span class="line">  <span class="attr">max</span>: <span class="number">100</span>, <span class="comment">// limit each IP to 100 requests per windowMs</span></span><br><span class="line">  <span class="attr">message</span>: <span class="string">&#x27;Too many requests from this IP&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, limiter);</span><br><span class="line"></span><br><span class="line"><span class="comment">// CORS configuration</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>(&#123;</span><br><span class="line">  <span class="attr">origin</span>: process.<span class="property">env</span>.<span class="property">CORS_ORIGIN</span>,</span><br><span class="line">  <span class="attr">credentials</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">methods</span>: [<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;PUT&#x27;</span>, <span class="string">&#x27;DELETE&#x27;</span>, <span class="string">&#x27;PATCH&#x27;</span>],</span><br><span class="line">  <span class="attr">allowedHeaders</span>: [<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;Authorization&#x27;</span>]</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Input sanitization</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>(&#123; <span class="attr">limit</span>: <span class="string">&#x27;10kb&#x27;</span> &#125;)); <span class="comment">// Limit payload size</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// XSS protection</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;X-XSS-Protection&#x27;</span>, <span class="string">&#x27;1; mode=block&#x27;</span>);</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Performance-Optimization"><a href="#Performance-Optimization" class="headerlink" title="Performance Optimization"></a>Performance Optimization</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Compression</span></span><br><span class="line"><span class="keyword">const</span> compression = <span class="built_in">require</span>(<span class="string">&#x27;compression&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">compression</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Caching</span></span><br><span class="line"><span class="keyword">const</span> cache = <span class="built_in">require</span>(<span class="string">&#x27;memory-cache&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">cacheMiddleware</span> = (<span class="params">duration</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> key = <span class="string">`__express__<span class="subst">$&#123;req.originalUrl&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">const</span> cachedBody = cache.<span class="title function_">get</span>(key);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (cachedBody) &#123;</span><br><span class="line">      res.<span class="title function_">send</span>(cachedBody);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    res.<span class="property">sendResponse</span> = res.<span class="property">send</span>;</span><br><span class="line">    res.<span class="property">send</span> = <span class="function">(<span class="params">body</span>) =&gt;</span> &#123;</span><br><span class="line">      cache.<span class="title function_">put</span>(key, body, duration * <span class="number">1000</span>);</span><br><span class="line">      res.<span class="title function_">sendResponse</span>(body);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/users&#x27;</span>, <span class="title function_">cacheMiddleware</span>(<span class="number">300</span>), userController.<span class="property">getAllUsers</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> winston = <span class="built_in">require</span>(<span class="string">&#x27;winston&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure logger</span></span><br><span class="line"><span class="keyword">const</span> logger = winston.<span class="title function_">createLogger</span>(&#123;</span><br><span class="line">  <span class="attr">level</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">  <span class="attr">format</span>: winston.<span class="property">format</span>.<span class="title function_">combine</span>(</span><br><span class="line">    winston.<span class="property">format</span>.<span class="title function_">timestamp</span>(),</span><br><span class="line">    winston.<span class="property">format</span>.<span class="title function_">json</span>()</span><br><span class="line">  ),</span><br><span class="line">  <span class="attr">transports</span>: [</span><br><span class="line">    <span class="keyword">new</span> winston.<span class="property">transports</span>.<span class="title class_">File</span>(&#123; <span class="attr">filename</span>: <span class="string">&#x27;error.log&#x27;</span>, <span class="attr">level</span>: <span class="string">&#x27;error&#x27;</span> &#125;),</span><br><span class="line">    <span class="keyword">new</span> winston.<span class="property">transports</span>.<span class="title class_">File</span>(&#123; <span class="attr">filename</span>: <span class="string">&#x27;combined.log&#x27;</span> &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span>) &#123;</span><br><span class="line">  logger.<span class="title function_">add</span>(<span class="keyword">new</span> winston.<span class="property">transports</span>.<span class="title class_">Console</span>(&#123;</span><br><span class="line">    <span class="attr">format</span>: winston.<span class="property">format</span>.<span class="title function_">simple</span>()</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Logging middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  logger.<span class="title function_">info</span>(<span class="string">`<span class="subst">$&#123;req.method&#125;</span> <span class="subst">$&#123;req.url&#125;</span>`</span>, &#123;</span><br><span class="line">    <span class="attr">ip</span>: req.<span class="property">ip</span>,</span><br><span class="line">    <span class="attr">userAgent</span>: req.<span class="title function_">get</span>(<span class="string">&#x27;User-Agent&#x27;</span>)</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="6-Vi-du-thuc-te"><a href="#6-Vi-du-thuc-te" class="headerlink" title="6. Ví dụ thực tế"></a>6. Ví dụ thực tế</h2><h3 id="REST-API-Example"><a href="#REST-API-Example" class="headerlink" title="REST API Example"></a>REST API Example</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> helmet = <span class="built_in">require</span>(<span class="string">&#x27;helmet&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> morgan = <span class="built_in">require</span>(<span class="string">&#x27;morgan&#x27;</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;dotenv&#x27;</span>).<span class="title function_">config</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">helmet</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">morgan</span>(<span class="string">&#x27;combined&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>(&#123; <span class="attr">limit</span>: <span class="string">&#x27;10kb&#x27;</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Routes</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/auth&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;./routes/authRoutes&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/users&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;./routes/userRoutes&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/products&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;./routes/productRoutes&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Error handling</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err.<span class="property">stack</span>);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Something went wrong!&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 404 handler</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;*&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Route not found&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>;</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running on port <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Authentication-System"><a href="#Authentication-System" class="headerlink" title="Authentication System"></a>Authentication System</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// authController.js</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = <span class="built_in">require</span>(<span class="string">&#x27;../models/User&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> authController = &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">register</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; name, email, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Check if user exists</span></span><br><span class="line">      <span class="keyword">const</span> existingUser = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123; email &#125;);</span><br><span class="line">      <span class="keyword">if</span> (existingUser) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Email already registered&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Hash password</span></span><br><span class="line">      <span class="keyword">const</span> hashedPassword = <span class="keyword">await</span> bcrypt.<span class="title function_">hash</span>(password, <span class="number">12</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Create user</span></span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        name,</span><br><span class="line">        email,</span><br><span class="line">        <span class="attr">password</span>: hashedPassword</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Generate token</span></span><br><span class="line">      <span class="keyword">const</span> token = jwt.<span class="title function_">sign</span>(</span><br><span class="line">        &#123; <span class="attr">userId</span>: user.<span class="property">_id</span> &#125;,</span><br><span class="line">        process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">        &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;7d&#x27;</span> &#125;</span><br><span class="line">      );</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;User registered successfully&#x27;</span>,</span><br><span class="line">        token,</span><br><span class="line">        <span class="attr">user</span>: &#123;</span><br><span class="line">          <span class="attr">id</span>: user.<span class="property">_id</span>,</span><br><span class="line">          <span class="attr">name</span>: user.<span class="property">name</span>,</span><br><span class="line">          <span class="attr">email</span>: user.<span class="property">email</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Registration failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; email, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Find user</span></span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123; email &#125;);</span><br><span class="line">      <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid credentials&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Check password</span></span><br><span class="line">      <span class="keyword">const</span> isValidPassword = <span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(password, user.<span class="property">password</span>);</span><br><span class="line">      <span class="keyword">if</span> (!isValidPassword) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid credentials&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Generate token</span></span><br><span class="line">      <span class="keyword">const</span> token = jwt.<span class="title function_">sign</span>(</span><br><span class="line">        &#123; <span class="attr">userId</span>: user.<span class="property">_id</span> &#125;,</span><br><span class="line">        process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">        &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;7d&#x27;</span> &#125;</span><br><span class="line">      );</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Login successful&#x27;</span>,</span><br><span class="line">        token,</span><br><span class="line">        <span class="attr">user</span>: &#123;</span><br><span class="line">          <span class="attr">id</span>: user.<span class="property">_id</span>,</span><br><span class="line">          <span class="attr">name</span>: user.<span class="property">name</span>,</span><br><span class="line">          <span class="attr">email</span>: user.<span class="property">email</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Login failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = authController;</span><br></pre></td></tr></table></figure>

<h3 id="CRUD-Operations"><a href="#CRUD-Operations" class="headerlink" title="CRUD Operations"></a>CRUD Operations</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// userController.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = <span class="built_in">require</span>(<span class="string">&#x27;../models/User&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userController = &#123;</span><br><span class="line">  <span class="comment">// Get all users</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getAllUsers</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; page = <span class="number">1</span>, limit = <span class="number">10</span>, search &#125; = req.<span class="property">query</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> query = &#123;&#125;;</span><br><span class="line">      <span class="keyword">if</span> (search) &#123;</span><br><span class="line">        query.<span class="property">$or</span> = [</span><br><span class="line">          &#123; <span class="attr">name</span>: &#123; <span class="attr">$regex</span>: search, <span class="attr">$options</span>: <span class="string">&#x27;i&#x27;</span> &#125; &#125;,</span><br><span class="line">          &#123; <span class="attr">email</span>: &#123; <span class="attr">$regex</span>: search, <span class="attr">$options</span>: <span class="string">&#x27;i&#x27;</span> &#125; &#125;</span><br><span class="line">        ];</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> users = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">find</span>(query)</span><br><span class="line">        .<span class="title function_">select</span>(<span class="string">&#x27;-password&#x27;</span>)</span><br><span class="line">        .<span class="title function_">limit</span>(limit * <span class="number">1</span>)</span><br><span class="line">        .<span class="title function_">skip</span>((page - <span class="number">1</span>) * limit)</span><br><span class="line">        .<span class="title function_">exec</span>();</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> count = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">countDocuments</span>(query);</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(&#123;</span><br><span class="line">        users,</span><br><span class="line">        <span class="attr">totalPages</span>: <span class="title class_">Math</span>.<span class="title function_">ceil</span>(count / limit),</span><br><span class="line">        <span class="attr">currentPage</span>: page</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Failed to fetch users&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Get user by ID</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUserById</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findById</span>(req.<span class="property">params</span>.<span class="property">id</span>).<span class="title function_">select</span>(<span class="string">&#x27;-password&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;User not found&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(user);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Failed to fetch user&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Update user</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">updateUser</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; name, email &#125; = req.<span class="property">body</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findByIdAndUpdate</span>(</span><br><span class="line">        req.<span class="property">params</span>.<span class="property">id</span>,</span><br><span class="line">        &#123; name, email &#125;,</span><br><span class="line">        &#123; <span class="attr">new</span>: <span class="literal">true</span>, <span class="attr">runValidators</span>: <span class="literal">true</span> &#125;</span><br><span class="line">      ).<span class="title function_">select</span>(<span class="string">&#x27;-password&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;User not found&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(user);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Failed to update user&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Delete user</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">deleteUser</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findByIdAndDelete</span>(req.<span class="property">params</span>.<span class="property">id</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;User not found&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">204</span>).<span class="title function_">send</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Failed to delete user&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = userController;</span><br></pre></td></tr></table></figure>

<h3 id="File-Upload-System"><a href="#File-Upload-System" class="headerlink" title="File Upload System"></a>File Upload System</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// uploadController.js</span></span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&#x27;multer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>).<span class="property">promises</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure storage</span></span><br><span class="line"><span class="keyword">const</span> storage = multer.<span class="title function_">diskStorage</span>(&#123;</span><br><span class="line">  <span class="attr">destination</span>: <span class="title function_">async</span> (req, file, cb) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> uploadDir = <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> fs.<span class="title function_">mkdir</span>(uploadDir, &#123; <span class="attr">recursive</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">      <span class="title function_">cb</span>(<span class="literal">null</span>, uploadDir);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="title function_">cb</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">filename</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>() + path.<span class="title function_">extname</span>(file.<span class="property">originalname</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123;</span><br><span class="line">  storage,</span><br><span class="line">  <span class="attr">limits</span>: &#123;</span><br><span class="line">    <span class="attr">fileSize</span>: <span class="number">5</span> * <span class="number">1024</span> * <span class="number">1024</span> <span class="comment">// 5MB</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">fileFilter</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> allowedTypes = <span class="regexp">/jpeg|jpg|png|gif|pdf|doc|docx/</span>;</span><br><span class="line">    <span class="keyword">const</span> extname = allowedTypes.<span class="title function_">test</span>(path.<span class="title function_">extname</span>(file.<span class="property">originalname</span>).<span class="title function_">toLowerCase</span>());</span><br><span class="line">    <span class="keyword">const</span> mimetype = allowedTypes.<span class="title function_">test</span>(file.<span class="property">mimetype</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (mimetype &amp;&amp; extname) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Invalid file type&#x27;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> uploadController = &#123;</span><br><span class="line">  <span class="comment">// Single file upload</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">uploadFile</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!req.<span class="property">file</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;No file uploaded&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">        <span class="attr">filename</span>: req.<span class="property">file</span>.<span class="property">filename</span>,</span><br><span class="line">        <span class="attr">originalName</span>: req.<span class="property">file</span>.<span class="property">originalname</span>,</span><br><span class="line">        <span class="attr">size</span>: req.<span class="property">file</span>.<span class="property">size</span>,</span><br><span class="line">        <span class="attr">mimetype</span>: req.<span class="property">file</span>.<span class="property">mimetype</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Upload failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Multiple files upload</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">uploadMultipleFiles</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!req.<span class="property">files</span> || req.<span class="property">files</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;No files uploaded&#x27;</span> &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">const</span> files = req.<span class="property">files</span>.<span class="title function_">map</span>(<span class="function"><span class="params">file</span> =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">filename</span>: file.<span class="property">filename</span>,</span><br><span class="line">        <span class="attr">originalName</span>: file.<span class="property">originalname</span>,</span><br><span class="line">        <span class="attr">size</span>: file.<span class="property">size</span>,</span><br><span class="line">        <span class="attr">mimetype</span>: file.<span class="property">mimetype</span></span><br><span class="line">      &#125;));</span><br><span class="line">      </span><br><span class="line">      res.<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Files uploaded successfully&#x27;</span>,</span><br><span class="line">        files</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Upload failed&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; upload, uploadController &#125;;</span><br></pre></td></tr></table></figure>

<h2 id="7-Troubleshooting-va-tips"><a href="#7-Troubleshooting-va-tips" class="headerlink" title="7. Troubleshooting và tips"></a>7. Troubleshooting và tips</h2><h3 id="Common-Issues"><a href="#Common-Issues" class="headerlink" title="Common Issues"></a>Common Issues</h3><h4 id="1-CORS-Errors"><a href="#1-CORS-Errors" class="headerlink" title="1. CORS Errors"></a>1. CORS Errors</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Problem: CORS errors in browser</span></span><br><span class="line"><span class="comment">// Solution: Configure CORS properly</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>(&#123;</span><br><span class="line">  <span class="attr">origin</span>: [<span class="string">&#x27;http://localhost:3000&#x27;</span>, <span class="string">&#x27;https://yourdomain.com&#x27;</span>],</span><br><span class="line">  <span class="attr">credentials</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">methods</span>: [<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;PUT&#x27;</span>, <span class="string">&#x27;DELETE&#x27;</span>, <span class="string">&#x27;PATCH&#x27;</span>],</span><br><span class="line">  <span class="attr">allowedHeaders</span>: [<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;Authorization&#x27;</span>]</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<h4 id="2-Body-Parser-Issues"><a href="#2-Body-Parser-Issues" class="headerlink" title="2. Body Parser Issues"></a>2. Body Parser Issues</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Problem: req.body is undefined</span></span><br><span class="line"><span class="comment">// Solution: Add body parser middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// For raw body</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">raw</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;));</span><br></pre></td></tr></table></figure>

<h4 id="3-Async-Await-Error-Handling"><a href="#3-Async-Await-Error-Handling" class="headerlink" title="3. Async&#x2F;Await Error Handling"></a>3. Async&#x2F;Await Error Handling</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Problem: Unhandled promise rejections</span></span><br><span class="line"><span class="comment">// Solution: Use try-catch or error handling middleware</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">asyncHandler</span> = (<span class="params">fn</span>) =&gt; <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="title function_">fn</span>(req, res, next)).<span class="title function_">catch</span>(next);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="title function_">asyncHandler</span>(<span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> users = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">find</span>();</span><br><span class="line">  res.<span class="title function_">json</span>(users);</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<h4 id="4-Static-Files-Not-Serving"><a href="#4-Static-Files-Not-Serving" class="headerlink" title="4. Static Files Not Serving"></a>4. Static Files Not Serving</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Problem: Static files not accessible</span></span><br><span class="line"><span class="comment">// Solution: Configure static middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/uploads&#x27;</span>, express.<span class="title function_">static</span>(<span class="string">&#x27;uploads&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// With options</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/static&#x27;</span>, express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">maxAge</span>: <span class="string">&#x27;1d&#x27;</span>,</span><br><span class="line">  <span class="attr">etag</span>: <span class="literal">true</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<h4 id="5-Session-Issues"><a href="#5-Session-Issues" class="headerlink" title="5. Session Issues"></a>5. Session Issues</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Problem: Sessions not persisting</span></span><br><span class="line"><span class="comment">// Solution: Configure session properly</span></span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">  <span class="attr">secret</span>: process.<span class="property">env</span>.<span class="property">SESSION_SECRET</span>,</span><br><span class="line">  <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">saveUninitialized</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">cookie</span>: &#123;</span><br><span class="line">    <span class="attr">secure</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">    <span class="attr">httpOnly</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">maxAge</span>: <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 24 hours</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<h3 id="Debugging-Tips"><a href="#Debugging-Tips" class="headerlink" title="Debugging Tips"></a>Debugging Tips</h3><h4 id="1-Request-Logging"><a href="#1-Request-Logging" class="headerlink" title="1. Request Logging"></a>1. Request Logging</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Morgan logging</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">morgan</span>(<span class="string">&#x27;combined&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom logging</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toISOString()&#125;</span> - <span class="subst">$&#123;req.method&#125;</span> <span class="subst">$&#123;req.url&#125;</span>`</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Headers:&#x27;</span>, req.<span class="property">headers</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Body:&#x27;</span>, req.<span class="property">body</span>);</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="2-Error-Tracking"><a href="#2-Error-Tracking" class="headerlink" title="2. Error Tracking"></a>2. Error Tracking</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Global error handler</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, err);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Stack:&#x27;</span>, err.<span class="property">stack</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Log to external service</span></span><br><span class="line">  <span class="comment">// logger.error(err);</span></span><br><span class="line">  </span><br><span class="line">  res.<span class="title function_">status</span>(err.<span class="property">status</span> || <span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">error</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span> ? err.<span class="property">message</span> : <span class="string">&#x27;Internal server error&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="3-Performance-Monitoring"><a href="#3-Performance-Monitoring" class="headerlink" title="3. Performance Monitoring"></a>3. Performance Monitoring</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Response time middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> start = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">  </span><br><span class="line">  res.<span class="title function_">on</span>(<span class="string">&#x27;finish&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> duration = <span class="title class_">Date</span>.<span class="title function_">now</span>() - start;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;req.method&#125;</span> <span class="subst">$&#123;req.url&#125;</span> - <span class="subst">$&#123;res.statusCode&#125;</span> - <span class="subst">$&#123;duration&#125;</span>ms`</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="4-Memory-Leaks"><a href="#4-Memory-Leaks" class="headerlink" title="4. Memory Leaks"></a>4. Memory Leaks</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Monitor memory usage</span></span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> used = process.<span class="title function_">memoryUsage</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Memory usage:&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">rss</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.round(used.rss / <span class="number">1024</span> / <span class="number">1024</span> * <span class="number">100</span>) / <span class="number">100</span>&#125;</span> MB`</span>,</span><br><span class="line">    <span class="attr">heapTotal</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.round(used.heapTotal / <span class="number">1024</span> / <span class="number">1024</span> * <span class="number">100</span>) / <span class="number">100</span>&#125;</span> MB`</span>,</span><br><span class="line">    <span class="attr">heapUsed</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.round(used.heapUsed / <span class="number">1024</span> / <span class="number">1024</span> * <span class="number">100</span>) / <span class="number">100</span>&#125;</span> MB`</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">30000</span>);</span><br></pre></td></tr></table></figure>

<h2 id="8-Tai-lieu-tham-khao"><a href="#8-Tai-lieu-tham-khao" class="headerlink" title="8. Tài liệu tham khảo"></a>8. Tài liệu tham khảo</h2><h3 id="Official-Documentation"><a href="#Official-Documentation" class="headerlink" title="Official Documentation"></a>Official Documentation</h3><ul>
<li><a href="https://expressjs.com/">Express.js Documentation</a></li>
<li><a href="https://nodejs.org/docs/">Node.js Documentation</a></li>
<li><a href="https://expressjs.com/en/4x/api.html">Express.js API Reference</a></li>
</ul>
<h3 id="Learning-Resources"><a href="#Learning-Resources" class="headerlink" title="Learning Resources"></a>Learning Resources</h3><ul>
<li><a href="https://expressjs.com/en/guide/routing.html">Express.js Guide</a></li>
<li><a href="https://expressjs.com/en/advanced/best-practices-security.html">Express.js Security Best Practices</a></li>
<li><a href="https://expressjs.com/en/advanced/best-practices-performance.html">Express.js Performance Best Practices</a></li>
</ul>
<h3 id="Tools-Middleware"><a href="#Tools-Middleware" class="headerlink" title="Tools &amp; Middleware"></a>Tools &amp; Middleware</h3><ul>
<li><a href="https://helmetjs.github.io/">Helmet</a> - Security middleware</li>
<li><a href="https://github.com/expressjs/morgan">Morgan</a> - HTTP request logger</li>
<li><a href="https://github.com/expressjs/cors">CORS</a> - Cross-origin resource sharing</li>
<li><a href="https://github.com/expressjs/multer">Multer</a> - File upload handling</li>
<li><a href="https://express-validator.github.io/">Express Validator</a> - Input validation</li>
</ul>
<h3 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h3><ul>
<li><a href="https://jestjs.io/">Jest</a> - Testing framework</li>
<li><a href="https://github.com/visionmedia/supertest">Supertest</a> - HTTP testing</li>
<li><a href="https://mochajs.org/">Mocha</a> - Test runner</li>
<li><a href="https://www.chaijs.com/">Chai</a> - Assertion library</li>
</ul>
<h3 id="Database-Integration-1"><a href="#Database-Integration-1" class="headerlink" title="Database Integration"></a>Database Integration</h3><ul>
<li><a href="https://mongoosejs.com/">Mongoose</a> - MongoDB ODM</li>
<li><a href="https://sequelize.org/">Sequelize</a> - SQL ORM</li>
<li><a href="https://www.prisma.io/">Prisma</a> - Database toolkit</li>
<li><a href="https://typeorm.io/">TypeORM</a> - TypeScript ORM</li>
</ul>
<h3 id="Authentication-Security"><a href="#Authentication-Security" class="headerlink" title="Authentication &amp; Security"></a>Authentication &amp; Security</h3><ul>
<li><a href="http://www.passportjs.org/">Passport.js</a> - Authentication middleware</li>
<li><a href="https://jwt.io/">JWT</a> - JSON Web Tokens</li>
<li><a href="https://github.com/dcodeIO/bcrypt.js">Bcrypt</a> - Password hashing</li>
<li><a href="https://github.com/nfriedly/express-rate-limit">Express Rate Limit</a> - Rate limiting</li>
</ul>
<hr>
<p><strong>🎯 Kết quả sau khi học ExpressJS:</strong></p>
<ul>
<li>✅ Hiểu sâu về ExpressJS architecture và middleware</li>
<li>✅ Thành thạo routing và HTTP methods</li>
<li>✅ Build RESTful APIs và web applications</li>
<li>✅ Implement authentication và authorization</li>
<li>✅ Handle file uploads và static files</li>
<li>✅ Integrate databases và ORMs</li>
<li>✅ Apply security best practices</li>
<li>✅ Test và deploy ExpressJS applications</li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Vui lòng kích hoạt JavaScript để xem các bình luận.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Trang chủ</a></li>
        
          <li><a href="/about/">Giới thiệu</a></li>
        
          <li><a href="/archives/">Bài viết</a></li>
        
          <li><a href="https://github.com/ph4n4n">Dự án</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-ExpressJS-Web-Framework-tu-co-ban-den-nang-cao"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: ExpressJS - Web Framework từ cơ bản đến nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Gioi-thieu-va-khai-niem-co-ban"><span class="toc-number">1.1.</span> <span class="toc-text">1. Giới thiệu và khái niệm cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ExpressJS-la-gi"><span class="toc-number">1.1.1.</span> <span class="toc-text">ExpressJS là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dac-diem-chinh"><span class="toc-number">1.1.2.</span> <span class="toc-text">Đặc điểm chính:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-cases-pho-bien"><span class="toc-number">1.1.3.</span> <span class="toc-text">Use cases phổ biến:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ExpressJS-vs-Other-Frameworks"><span class="toc-number">1.1.4.</span> <span class="toc-text">ExpressJS vs Other Frameworks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ExpressJS-Architecture"><span class="toc-number">1.1.5.</span> <span class="toc-text">ExpressJS Architecture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Core-Concepts"><span class="toc-number">1.1.6.</span> <span class="toc-text">Core Concepts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Cai-dat-va-setup-moi-truong"><span class="toc-number">1.2.</span> <span class="toc-text">2. Cài đặt và setup môi trường</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Project-Setup"><span class="toc-number">1.2.1.</span> <span class="toc-text">Project Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Project-Structure"><span class="toc-number">1.2.2.</span> <span class="toc-text">Basic Project Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Package-json-Configuration"><span class="toc-number">1.2.3.</span> <span class="toc-text">Package.json Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Environment-Configuration"><span class="toc-number">1.2.4.</span> <span class="toc-text">Environment Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ESLint-Configuration"><span class="toc-number">1.2.5.</span> <span class="toc-text">ESLint Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VS-Code-Extensions"><span class="toc-number">1.2.6.</span> <span class="toc-text">VS Code Extensions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Cu-phap-va-cau-truc-co-ban"><span class="toc-number">1.3.</span> <span class="toc-text">3. Cú pháp và cấu trúc cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Express-App"><span class="toc-number">1.3.1.</span> <span class="toc-text">Basic Express App</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Methods"><span class="toc-number">1.3.2.</span> <span class="toc-text">HTTP Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Route-Parameters"><span class="toc-number">1.3.3.</span> <span class="toc-text">Route Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-Parameters"><span class="toc-number">1.3.4.</span> <span class="toc-text">Query Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Request-Body"><span class="toc-number">1.3.5.</span> <span class="toc-text">Request Body</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Response-Methods"><span class="toc-number">1.3.6.</span> <span class="toc-text">Response Methods</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Cac-tinh-nang-nang-cao"><span class="toc-number">1.4.</span> <span class="toc-text">4. Các tính năng nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Middleware"><span class="toc-number">1.4.1.</span> <span class="toc-text">Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Router"><span class="toc-number">1.4.2.</span> <span class="toc-text">Router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Error-Handling"><span class="toc-number">1.4.3.</span> <span class="toc-text">Error Handling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-Authorization"><span class="toc-number">1.4.4.</span> <span class="toc-text">Authentication &amp; Authorization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-Upload"><span class="toc-number">1.4.5.</span> <span class="toc-text">File Upload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-Integration"><span class="toc-number">1.4.6.</span> <span class="toc-text">Database Integration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Validation"><span class="toc-number">1.4.7.</span> <span class="toc-text">Validation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Best-practices-va-patterns"><span class="toc-number">1.5.</span> <span class="toc-text">5. Best practices và patterns</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Project-Structure"><span class="toc-number">1.5.1.</span> <span class="toc-text">Project Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security-Best-Practices"><span class="toc-number">1.5.2.</span> <span class="toc-text">Security Best Practices</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance-Optimization"><span class="toc-number">1.5.3.</span> <span class="toc-text">Performance Optimization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Logging"><span class="toc-number">1.5.4.</span> <span class="toc-text">Logging</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Vi-du-thuc-te"><span class="toc-number">1.6.</span> <span class="toc-text">6. Ví dụ thực tế</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#REST-API-Example"><span class="toc-number">1.6.1.</span> <span class="toc-text">REST API Example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-System"><span class="toc-number">1.6.2.</span> <span class="toc-text">Authentication System</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRUD-Operations"><span class="toc-number">1.6.3.</span> <span class="toc-text">CRUD Operations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-Upload-System"><span class="toc-number">1.6.4.</span> <span class="toc-text">File Upload System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Troubleshooting-va-tips"><span class="toc-number">1.7.</span> <span class="toc-text">7. Troubleshooting và tips</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Common-Issues"><span class="toc-number">1.7.1.</span> <span class="toc-text">Common Issues</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-CORS-Errors"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">1. CORS Errors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Body-Parser-Issues"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">2. Body Parser Issues</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Async-Await-Error-Handling"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">3. Async&#x2F;Await Error Handling</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Static-Files-Not-Serving"><span class="toc-number">1.7.1.4.</span> <span class="toc-text">4. Static Files Not Serving</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Session-Issues"><span class="toc-number">1.7.1.5.</span> <span class="toc-text">5. Session Issues</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Debugging-Tips"><span class="toc-number">1.7.2.</span> <span class="toc-text">Debugging Tips</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Request-Logging"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">1. Request Logging</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Error-Tracking"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">2. Error Tracking</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Performance-Monitoring"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">3. Performance Monitoring</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Memory-Leaks"><span class="toc-number">1.7.2.4.</span> <span class="toc-text">4. Memory Leaks</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Tai-lieu-tham-khao"><span class="toc-number">1.8.</span> <span class="toc-text">8. Tài liệu tham khảo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Official-Documentation"><span class="toc-number">1.8.1.</span> <span class="toc-text">Official Documentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Learning-Resources"><span class="toc-number">1.8.2.</span> <span class="toc-text">Learning Resources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tools-Middleware"><span class="toc-number">1.8.3.</span> <span class="toc-text">Tools &amp; Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Testing"><span class="toc-number">1.8.4.</span> <span class="toc-text">Testing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-Integration-1"><span class="toc-number">1.8.5.</span> <span class="toc-text">Database Integration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-Security"><span class="toc-number">1.8.6.</span> <span class="toc-text">Authentication &amp; Security</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&text=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&is_video=false&description=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao&body=Check out this article: https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&title=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&name=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/2025/06/26/Zero-to-hero-ExpressJS/&t=Zero to Hero: ExpressJS - Web Framework Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Chia sẻ</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Về đầu trang</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Bản quyền &copy;
    
    
    2018-2025
    ph4n4n
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'https-ph4n4n-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->


<script>
(function() {
  var fallbackQuotes = [
    {q: 'Stay hungry, stay foolish.', a: 'Steve Jobs'},
    {q: 'Không có thành công nào mà không phải trả giá.', a: 'Ẩn danh'},
    {q: 'Simplicity is the soul of efficiency.', a: 'Austin Freeman'},
    {q: 'Hãy kiên trì, mọi thứ rồi sẽ ổn.', a: 'Ẩn danh'},
    {q: 'Code is like humor. When you have to explain it, it\'s bad.', a: 'Cory House'},
    {q: 'Chỉ cần bạn không dừng lại thì việc bạn tiến chậm cũng không là vấn đề.', a: 'Khổng Tử'},
    {q: 'The best way to get started is to quit talking and begin doing.', a: 'Walt Disney'},
    {q: 'Muốn đi nhanh thì đi một mình, muốn đi xa thì đi cùng nhau.', a: 'Tục ngữ'},
    {q: 'First, solve the problem. Then, write the code.', a: 'John Johnson'},
    {q: 'Đừng sợ thất bại, hãy sợ không thử.', a: 'Ẩn danh'},
    {q: 'No code no bug, no bug no life.', a: 'ph4n4n'},
    {q: 'No code no bug, no code no food.', a: 'ph4n4n'},
    {q: 'The only way to do great work is to love what you do.', a: 'Steve Jobs'},
    {q: 'Je suis món ennemi.', a: 'ph4n4n'},
    {q: 'Chết không phải lúc trái tim ngừng đập, chết là khi ý chí ngừng tiến lên.', a: 'ChatGPT'},
  ];
  var el = document.getElementById('random-quote');
  function showQuote(q, a) {
    if (el) el.innerHTML = q + (a ? ' <span style="font-size:0.95em;color:#888;">– ' + a + '</span>' : '');
  }
  function showFallback() {
    var r = fallbackQuotes[Math.floor(Math.random() * fallbackQuotes.length)];
    showQuote(r.q, r.a);
  }
  fetch('https://zenquotes.io/api/random')
    .then(function(res) { return res.ok ? res.json() : Promise.reject(); })
    .then(function(data) {
      if (Array.isArray(data) && data[0] && data[0].q) {
        showQuote(data[0].q, data[0].a);
      } else {
        showFallback();
      }
    })
    .catch(showFallback);
})();
</script>
</body>
</html>
