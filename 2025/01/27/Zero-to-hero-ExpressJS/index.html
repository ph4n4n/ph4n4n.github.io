<!DOCTYPE html>
<html lang=vi>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Zero to Hero: Express.js - Web framework cho Node.js từ cơ bản đến nâng caoExpress.js là web framework phổ biến nhất cho Node.js, cung cấp các tính năng mạnh mẽ để xây dựng web applications và REST AP">
<meta property="og:type" content="article">
<meta property="og:title" content="Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao">
<meta property="og:url" content="https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/index.html">
<meta property="og:site_name" content="ph4n4n&#39;s code notes &amp; tips">
<meta property="og:description" content="Zero to Hero: Express.js - Web framework cho Node.js từ cơ bản đến nâng caoExpress.js là web framework phổ biến nhất cho Node.js, cung cấp các tính năng mạnh mẽ để xây dựng web applications và REST AP">
<meta property="og:locale" content="vi_VN">
<meta property="article:published_time" content="2025-01-27T03:00:00.000Z">
<meta property="article:modified_time" content="2025-06-26T09:43:04.978Z">
<meta property="article:author" content="ph4n4n">
<meta property="article:tag" content="Node.js">
<meta property="article:tag" content="Express.js">
<meta property="article:tag" content="Web Framework">
<meta property="article:tag" content="REST API">
<meta property="article:tag" content="Middleware">
<meta property="article:tag" content="Routing">
<meta property="article:tag" content="Backend">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- Monaco font override -->
    
<link rel="stylesheet" href="/css/monaco-override.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="ph4n4n&#39;s code notes &amp; tips" type="application/atom+xml" />
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Bài trước" href="/2025/06/20/ACID-trong-DBMS/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Bài tiếp theo" href="/2025/01/27/Zero-to-hero-Docker/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Về đầu trang" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Chia sẻ bài viết" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Bài trước</span>
      <span id="i-next" class="info" style="display:none;">Bài tiếp theo</span>
      <span id="i-top" class="info" style="display:none;">Về đầu trang</span>
      <span id="i-share" class="info" style="display:none;">Chia sẻ bài viết</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&text=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&is_video=false&description=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao&body=Check out this article: https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&name=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&t=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-Express-js-Web-framework-cho-Node-js-tu-co-ban-den-nang-cao"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: Express.js - Web framework cho Node.js từ cơ bản đến nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Express-js-la-gi"><span class="toc-number">1.1.</span> <span class="toc-text">1. Express.js là gì?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dac-diem-chinh"><span class="toc-number">1.1.1.</span> <span class="toc-text">Đặc điểm chính:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ung-dung-chinh"><span class="toc-number">1.1.2.</span> <span class="toc-text">Ứng dụng chính:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Cai-dat-va-Setup"><span class="toc-number">1.2.</span> <span class="toc-text">2. Cài đặt và Setup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Khoi-tao-project"><span class="toc-number">1.2.1.</span> <span class="toc-text">Khởi tạo project</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#package-json-co-ban"><span class="toc-number">1.2.2.</span> <span class="toc-text">package.json cơ bản</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-co-ban"><span class="toc-number">1.2.3.</span> <span class="toc-text">Server cơ bản</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Routing-co-ban"><span class="toc-number">1.3.</span> <span class="toc-text">3. Routing cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Methods"><span class="toc-number">1.3.1.</span> <span class="toc-text">HTTP Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Route-Parameters"><span class="toc-number">1.3.2.</span> <span class="toc-text">Route Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-Parameters"><span class="toc-number">1.3.3.</span> <span class="toc-text">Query Parameters</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Middleware"><span class="toc-number">1.4.</span> <span class="toc-text">4. Middleware</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Built-in-Middleware"><span class="toc-number">1.4.1.</span> <span class="toc-text">Built-in Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Third-party-Middleware"><span class="toc-number">1.4.2.</span> <span class="toc-text">Third-party Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Custom-Middleware"><span class="toc-number">1.4.3.</span> <span class="toc-text">Custom Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Middleware-Order"><span class="toc-number">1.4.4.</span> <span class="toc-text">Middleware Order</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Route-Organization"><span class="toc-number">1.5.</span> <span class="toc-text">5. Route Organization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Express-Router"><span class="toc-number">1.5.1.</span> <span class="toc-text">Express Router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Modular-Structure"><span class="toc-number">1.5.2.</span> <span class="toc-text">Modular Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Route-with-Controllers"><span class="toc-number">1.5.3.</span> <span class="toc-text">Route with Controllers</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Request-va-Response"><span class="toc-number">1.6.</span> <span class="toc-text">6. Request và Response</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Request-Object"><span class="toc-number">1.6.1.</span> <span class="toc-text">Request Object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Response-Object"><span class="toc-number">1.6.2.</span> <span class="toc-text">Response Object</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Error-Handling"><span class="toc-number">1.7.</span> <span class="toc-text">7. Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Try-Catch-trong-Routes"><span class="toc-number">1.7.1.</span> <span class="toc-text">Try-Catch trong Routes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Custom-Error-Classes"><span class="toc-number">1.7.2.</span> <span class="toc-text">Custom Error Classes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Global-Error-Handler"><span class="toc-number">1.7.3.</span> <span class="toc-text">Global Error Handler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Database-Integration"><span class="toc-number">1.8.</span> <span class="toc-text">8. Database Integration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-voi-Mongoose"><span class="toc-number">1.8.1.</span> <span class="toc-text">MongoDB với Mongoose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-voi-Sequelize"><span class="toc-number">1.8.2.</span> <span class="toc-text">MySQL với Sequelize</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Authentication-Authorization"><span class="toc-number">1.9.</span> <span class="toc-text">9. Authentication &amp; Authorization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT-Authentication"><span class="toc-number">1.9.1.</span> <span class="toc-text">JWT Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Role-based-Authorization"><span class="toc-number">1.9.2.</span> <span class="toc-text">Role-based Authorization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-File-Upload"><span class="toc-number">1.10.</span> <span class="toc-text">10. File Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Multer-Middleware"><span class="toc-number">1.10.1.</span> <span class="toc-text">Multer Middleware</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-Validation"><span class="toc-number">1.11.</span> <span class="toc-text">11. Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Express-Validator"><span class="toc-number">1.11.1.</span> <span class="toc-text">Express Validator</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-Testing"><span class="toc-number">1.12.</span> <span class="toc-text">12. Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jest-Testing"><span class="toc-number">1.12.1.</span> <span class="toc-text">Jest Testing</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Production-Best-Practices"><span class="toc-number">1.13.</span> <span class="toc-text">13. Production Best Practices</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Environment-Configuration"><span class="toc-number">1.13.1.</span> <span class="toc-text">Environment Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security-Middleware"><span class="toc-number">1.13.2.</span> <span class="toc-text">Security Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance-Optimization"><span class="toc-number">1.13.3.</span> <span class="toc-text">Performance Optimization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-Project-thuc-te"><span class="toc-number">1.14.</span> <span class="toc-text">14. Project thực tế</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#REST-API-voi-Express"><span class="toc-number">1.14.1.</span> <span class="toc-text">REST API với Express</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Microservice-voi-Express"><span class="toc-number">1.14.2.</span> <span class="toc-text">Microservice với Express</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9A-Tai-lieu-tham-khao"><span class="toc-number">1.15.</span> <span class="toc-text">📚 Tài liệu tham khảo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%AF-Ket-luan"><span class="toc-number">1.16.</span> <span class="toc-text">🎯 Kết luận</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ph4n4n</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-01-27T03:00:00.000Z" class="dt-published" itemprop="datePublished">2025-01-27</time>
        
        (Updated: <time datetime="2025-06-26T09:43:04.978Z" class="dt-updated" itemprop="dateModified">2025-06-26</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Backend/">Backend</a> › <a class="category-link" href="/categories/Backend/Node-js/">Node.js</a> › <a class="category-link" href="/categories/Backend/Node-js/Express-js/">Express.js</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Backend/" rel="tag">Backend</a>, <a class="p-category" href="/tags/Express-js/" rel="tag">Express.js</a>, <a class="p-category" href="/tags/Middleware/" rel="tag">Middleware</a>, <a class="p-category" href="/tags/Node-js/" rel="tag">Node.js</a>, <a class="p-category" href="/tags/REST-API/" rel="tag">REST API</a>, <a class="p-category" href="/tags/Routing/" rel="tag">Routing</a>, <a class="p-category" href="/tags/Web-Framework/" rel="tag">Web Framework</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Zero-to-Hero-Express-js-Web-framework-cho-Node-js-tu-co-ban-den-nang-cao"><a href="#Zero-to-Hero-Express-js-Web-framework-cho-Node-js-tu-co-ban-den-nang-cao" class="headerlink" title="Zero to Hero: Express.js - Web framework cho Node.js từ cơ bản đến nâng cao"></a>Zero to Hero: Express.js - Web framework cho Node.js từ cơ bản đến nâng cao</h1><p>Express.js là web framework phổ biến nhất cho Node.js, cung cấp các tính năng mạnh mẽ để xây dựng web applications và REST APIs một cách nhanh chóng và hiệu quả.</p>
<h2 id="1-Express-js-la-gi"><a href="#1-Express-js-la-gi" class="headerlink" title="1. Express.js là gì?"></a>1. Express.js là gì?</h2><p>Express.js là minimal và flexible web application framework cho Node.js, cung cấp robust set of features cho web và mobile applications. Express được tạo bởi TJ Holowaychuk và hiện được maintain bởi Node.js Foundation.</p>
<h3 id="Dac-diem-chinh"><a href="#Dac-diem-chinh" class="headerlink" title="Đặc điểm chính:"></a>Đặc điểm chính:</h3><ul>
<li><strong>Minimal</strong>: Framework nhẹ, không áp đặt cấu trúc</li>
<li><strong>Flexible</strong>: Dễ dàng customize và extend</li>
<li><strong>Fast</strong>: Performance cao, ít overhead</li>
<li><strong>Unopinionated</strong>: Không có convention cứng nhắc</li>
<li><strong>Middleware</strong>: Hệ thống middleware mạnh mẽ</li>
</ul>
<h3 id="Ung-dung-chinh"><a href="#Ung-dung-chinh" class="headerlink" title="Ứng dụng chính:"></a>Ứng dụng chính:</h3><ul>
<li><strong>REST APIs</strong>: Backend cho mobile&#x2F;web apps</li>
<li><strong>Web Applications</strong>: Full-stack web apps</li>
<li><strong>Microservices</strong>: Lightweight services</li>
<li><strong>Real-time Apps</strong>: Với Socket.io</li>
<li><strong>Static File Serving</strong>: File hosting</li>
</ul>
<h2 id="2-Cai-dat-va-Setup"><a href="#2-Cai-dat-va-Setup" class="headerlink" title="2. Cài đặt và Setup"></a>2. Cài đặt và Setup</h2><h3 id="Khoi-tao-project"><a href="#Khoi-tao-project" class="headerlink" title="Khởi tạo project"></a>Khởi tạo project</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Tạo thư mục project</span></span><br><span class="line"><span class="built_in">mkdir</span> express-app</span><br><span class="line"><span class="built_in">cd</span> express-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Khởi tạo package.json</span></span><br><span class="line">npm init -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cài đặt Express</span></span><br><span class="line">npm install express</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cài đặt dependencies phổ biến</span></span><br><span class="line">npm install cors helmet morgan dotenv</span><br><span class="line">npm install --save-dev nodemon</span><br></pre></td></tr></table></figure>

<h3 id="package-json-co-ban"><a href="#package-json-co-ban" class="headerlink" title="package.json cơ bản"></a>package.json cơ bản</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;express-app&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Express.js application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nodemon index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jest&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;express&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.18.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cors&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.8.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;helmet&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;morgan&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.10.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dotenv&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^16.0.3&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;nodemon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.0.1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Server-co-ban"><a href="#Server-co-ban" class="headerlink" title="Server cơ bản"></a>Server cơ bản</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Routes</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;Hello Express!&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start server</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running on port <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="3-Routing-co-ban"><a href="#3-Routing-co-ban" class="headerlink" title="3. Routing cơ bản"></a>3. Routing cơ bản</h2><h3 id="HTTP-Methods"><a href="#HTTP-Methods" class="headerlink" title="HTTP Methods"></a>HTTP Methods</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET - Lấy dữ liệu</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>([</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;Jane&#x27;</span> &#125;</span><br><span class="line">  ]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST - Tạo dữ liệu mới</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; name, email &#125; = req.<span class="property">body</span>;</span><br><span class="line">  <span class="comment">// Logic tạo user</span></span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123; </span><br><span class="line">    <span class="attr">id</span>: <span class="number">3</span>, </span><br><span class="line">    name, </span><br><span class="line">    email,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;User created successfully&#x27;</span> </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// PUT - Cập nhật toàn bộ resource</span></span><br><span class="line">app.<span class="title function_">put</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="keyword">const</span> &#123; name, email &#125; = req.<span class="property">body</span>;</span><br><span class="line">  <span class="comment">// Logic cập nhật user</span></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; </span><br><span class="line">    id, </span><br><span class="line">    name, </span><br><span class="line">    email,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;User updated successfully&#x27;</span> </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// PATCH - Cập nhật một phần resource</span></span><br><span class="line">app.<span class="title function_">patch</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="keyword">const</span> updates = req.<span class="property">body</span>;</span><br><span class="line">  <span class="comment">// Logic cập nhật một phần user</span></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; </span><br><span class="line">    id, </span><br><span class="line">    ...updates,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;User partially updated&#x27;</span> </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// DELETE - Xóa resource</span></span><br><span class="line">app.<span class="title function_">delete</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="comment">// Logic xóa user</span></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">`User <span class="subst">$&#123;id&#125;</span> deleted successfully`</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Route-Parameters"><a href="#Route-Parameters" class="headerlink" title="Route Parameters"></a>Route Parameters</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Single parameter</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Multiple parameters</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id/posts/:postId&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id, postId &#125; = req.<span class="property">params</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id, postId &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Optional parameters</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id?&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  <span class="keyword">if</span> (id) &#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;All users&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Regex parameters</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id([0-9]+)&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Query-Parameters"><a href="#Query-Parameters" class="headerlink" title="Query Parameters"></a>Query Parameters</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; page = <span class="number">1</span>, limit = <span class="number">10</span>, sort = <span class="string">&#x27;name&#x27;</span> &#125; = req.<span class="property">query</span>;</span><br><span class="line">  </span><br><span class="line">  res.<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">page</span>: <span class="built_in">parseInt</span>(page),</span><br><span class="line">    <span class="attr">limit</span>: <span class="built_in">parseInt</span>(limit),</span><br><span class="line">    sort,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;Users with filters&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// URL: /users?page=2&amp;limit=5&amp;sort=email</span></span><br></pre></td></tr></table></figure>

<h2 id="4-Middleware"><a href="#4-Middleware" class="headerlink" title="4. Middleware"></a>4. Middleware</h2><h3 id="Built-in-Middleware"><a href="#Built-in-Middleware" class="headerlink" title="Built-in Middleware"></a>Built-in Middleware</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parse JSON bodies</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parse URL-encoded bodies</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Serve static files</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Trust proxy (for reverse proxy)</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;trust proxy&#x27;</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Third-party-Middleware"><a href="#Third-party-Middleware" class="headerlink" title="Third-party Middleware"></a>Third-party Middleware</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> helmet = <span class="built_in">require</span>(<span class="string">&#x27;helmet&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> morgan = <span class="built_in">require</span>(<span class="string">&#x27;morgan&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// CORS - Cross-Origin Resource Sharing</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>(&#123;</span><br><span class="line">  <span class="attr">origin</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>,</span><br><span class="line">  <span class="attr">credentials</span>: <span class="literal">true</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Helmet - Security headers</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">helmet</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Morgan - HTTP request logger</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">morgan</span>(<span class="string">&#x27;combined&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="Custom-Middleware"><a href="#Custom-Middleware" class="headerlink" title="Custom Middleware"></a>Custom Middleware</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Logger middleware</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">logger</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toISOString()&#125;</span> - <span class="subst">$&#123;req.method&#125;</span> <span class="subst">$&#123;req.url&#125;</span>`</span>);</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Authentication middleware</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">authenticate</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> token = req.<span class="property">headers</span>.<span class="property">authorization</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;No token provided&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Verify token logic here</span></span><br><span class="line">  req.<span class="property">user</span> = &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;John&#x27;</span> &#125;; <span class="comment">// Mock user</span></span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Error handling middleware</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">errorHandler</span> = (<span class="params">err, req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err.<span class="property">stack</span>);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Something went wrong!&#x27;</span> &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apply middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(logger);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, authenticate);</span><br><span class="line">app.<span class="title function_">use</span>(errorHandler);</span><br></pre></td></tr></table></figure>

<h3 id="Middleware-Order"><a href="#Middleware-Order" class="headerlink" title="Middleware Order"></a>Middleware Order</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Order matters!</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>()); <span class="comment">// 1. Parse JSON first</span></span><br><span class="line">app.<span class="title function_">use</span>(logger); <span class="comment">// 2. Log requests</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, authenticate); <span class="comment">// 3. Auth for API routes</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/users&#x27;</span>, userRoutes); <span class="comment">// 4. Route handlers</span></span><br><span class="line">app.<span class="title function_">use</span>(errorHandler); <span class="comment">// 5. Error handling last</span></span><br></pre></td></tr></table></figure>

<h2 id="5-Route-Organization"><a href="#5-Route-Organization" class="headerlink" title="5. Route Organization"></a>5. Route Organization</h2><h3 id="Express-Router"><a href="#Express-Router" class="headerlink" title="Express Router"></a>Express Router</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes/users.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET /users</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;All users&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET /users/:id</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST /users</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; name, email &#125; = req.<span class="property">body</span>;</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123; name, email &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> userRoutes = <span class="built_in">require</span>(<span class="string">&#x27;./routes/users&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/users&#x27;</span>, userRoutes);</span><br></pre></td></tr></table></figure>

<h3 id="Modular-Structure"><a href="#Modular-Structure" class="headerlink" title="Modular Structure"></a>Modular Structure</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// routes/index.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userRoutes = <span class="built_in">require</span>(<span class="string">&#x27;./users&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> postRoutes = <span class="built_in">require</span>(<span class="string">&#x27;./posts&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> commentRoutes = <span class="built_in">require</span>(<span class="string">&#x27;./comments&#x27;</span>);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">use</span>(<span class="string">&#x27;/users&#x27;</span>, userRoutes);</span><br><span class="line">router.<span class="title function_">use</span>(<span class="string">&#x27;/posts&#x27;</span>, postRoutes);</span><br><span class="line">router.<span class="title function_">use</span>(<span class="string">&#x27;/comments&#x27;</span>, commentRoutes);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> routes = <span class="built_in">require</span>(<span class="string">&#x27;./routes&#x27;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, routes);</span><br></pre></td></tr></table></figure>

<h3 id="Route-with-Controllers"><a href="#Route-with-Controllers" class="headerlink" title="Route with Controllers"></a>Route with Controllers</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// controllers/userController.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserController</span> = &#123;</span><br><span class="line">  <span class="attr">getAllUsers</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;All users&#x27;</span> &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="attr">getUserById</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">userId</span>: id &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="attr">createUser</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name, email &#125; = req.<span class="property">body</span>;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123; name, email &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="attr">updateUser</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">const</span> updates = req.<span class="property">body</span>;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; id, ...updates &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="attr">deleteUser</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">`User <span class="subst">$&#123;id&#125;</span> deleted`</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">UserController</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// routes/users.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserController</span> = <span class="built_in">require</span>(<span class="string">&#x27;../controllers/userController&#x27;</span>);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title class_">UserController</span>.<span class="property">getAllUsers</span>);</span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="title class_">UserController</span>.<span class="property">getUserById</span>);</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title class_">UserController</span>.<span class="property">createUser</span>);</span><br><span class="line">router.<span class="title function_">put</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="title class_">UserController</span>.<span class="property">updateUser</span>);</span><br><span class="line">router.<span class="title function_">delete</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="title class_">UserController</span>.<span class="property">deleteUser</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<h2 id="6-Request-va-Response"><a href="#6-Request-va-Response" class="headerlink" title="6. Request và Response"></a>6. Request và Response</h2><h3 id="Request-Object"><a href="#Request-Object" class="headerlink" title="Request Object"></a>Request Object</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/example&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// URL và method</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">url</span>); <span class="comment">// /example</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">method</span>); <span class="comment">// GET</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">path</span>); <span class="comment">// /example</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Headers</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">headers</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="title function_">get</span>(<span class="string">&#x27;User-Agent&#x27;</span>));</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Query parameters</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>); <span class="comment">// ?name=john&amp;age=30</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Route parameters</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">params</span>); <span class="comment">// /users/:id</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Body (POST, PUT, PATCH)</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// IP address</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">ip</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Cookies</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">cookies</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Files (with multer)</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">files</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Response-Object"><a href="#Response-Object" class="headerlink" title="Response Object"></a>Response Object</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/response-examples&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// JSON response</span></span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;JSON response&#x27;</span> &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Status codes</span></span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;Created&#x27;</span> &#125;);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Not found&#x27;</span> &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Headers</span></span><br><span class="line">  res.<span class="title function_">set</span>(<span class="string">&#x27;X-Custom-Header&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">set</span>(&#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Redirect</span></span><br><span class="line">  res.<span class="title function_">redirect</span>(<span class="string">&#x27;/new-url&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">redirect</span>(<span class="number">301</span>, <span class="string">&#x27;/permanent-redirect&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Send different content types</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;&lt;h1&gt;HTML response&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">sendFile</span>(<span class="string">&#x27;/path/to/file.html&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">download</span>(<span class="string">&#x27;/path/to/file.pdf&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Cookies</span></span><br><span class="line">  res.<span class="title function_">cookie</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;value&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">maxAge</span>: <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>, <span class="comment">// 1 day</span></span><br><span class="line">    <span class="attr">httpOnly</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">secure</span>: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  res.<span class="title function_">clearCookie</span>(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="7-Error-Handling"><a href="#7-Error-Handling" class="headerlink" title="7. Error Handling"></a>7. Error Handling</h2><h3 id="Try-Catch-trong-Routes"><a href="#Try-Catch-trong-Routes" class="headerlink" title="Try-Catch trong Routes"></a>Try-Catch trong Routes</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="title function_">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">getUserById</span>(id);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;User not found&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    res.<span class="title function_">json</span>(user);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="title function_">next</span>(error); <span class="comment">// Pass to error handler</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Custom-Error-Classes"><a href="#Custom-Error-Classes" class="headerlink" title="Custom Error Classes"></a>Custom Error Classes</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AppError</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Error</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">message, statusCode</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(message);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">statusCode</span> = statusCode;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">`<span class="subst">$&#123;statusCode&#125;</span>`</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;4&#x27;</span>) ? <span class="string">&#x27;fail&#x27;</span> : <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isOperational</span> = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="title class_">Error</span>.<span class="title function_">captureStackTrace</span>(<span class="variable language_">this</span>, <span class="variable language_">this</span>.<span class="property">constructor</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="title function_">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">getUserById</span>(id);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AppError</span>(<span class="string">&#x27;User not found&#x27;</span>, <span class="number">404</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    res.<span class="title function_">json</span>(user);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="title function_">next</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Global-Error-Handler"><a href="#Global-Error-Handler" class="headerlink" title="Global Error Handler"></a>Global Error Handler</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">errorHandler</span> = (<span class="params">err, req, res, next</span>) =&gt; &#123;</span><br><span class="line">  err.<span class="property">statusCode</span> = err.<span class="property">statusCode</span> || <span class="number">500</span>;</span><br><span class="line">  err.<span class="property">status</span> = err.<span class="property">status</span> || <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span>) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(err.<span class="property">statusCode</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">      <span class="attr">status</span>: err.<span class="property">status</span>,</span><br><span class="line">      <span class="attr">error</span>: err,</span><br><span class="line">      <span class="attr">message</span>: err.<span class="property">message</span>,</span><br><span class="line">      <span class="attr">stack</span>: err.<span class="property">stack</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// Production error response</span></span><br><span class="line">    <span class="keyword">if</span> (err.<span class="property">isOperational</span>) &#123;</span><br><span class="line">      res.<span class="title function_">status</span>(err.<span class="property">statusCode</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: err.<span class="property">status</span>,</span><br><span class="line">        <span class="attr">message</span>: err.<span class="property">message</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// Programming or unknown errors</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;ERROR 💥&#x27;</span>, err);</span><br><span class="line">      res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;Something went wrong!&#x27;</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(errorHandler);</span><br></pre></td></tr></table></figure>

<h2 id="8-Database-Integration"><a href="#8-Database-Integration" class="headerlink" title="8. Database Integration"></a>8. Database Integration</h2><h3 id="MongoDB-voi-Mongoose"><a href="#MongoDB-voi-Mongoose" class="headerlink" title="MongoDB với Mongoose"></a>MongoDB với Mongoose</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Connect to MongoDB</span></span><br><span class="line">mongoose.<span class="title function_">connect</span>(<span class="string">&#x27;mongodb://localhost:27017/myapp&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">useNewUrlParser</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">useUnifiedTopology</span>: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// User Model</span></span><br><span class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">email</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">unique</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">age</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">min</span>: <span class="number">0</span> &#125;,</span><br><span class="line">  <span class="attr">createdAt</span>: &#123; <span class="attr">type</span>: <span class="title class_">Date</span>, <span class="attr">default</span>: <span class="title class_">Date</span>.<span class="property">now</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = mongoose.<span class="title function_">model</span>(<span class="string">&#x27;User&#x27;</span>, userSchema);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Routes với database</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="title function_">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> users = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">find</span>();</span><br><span class="line">    res.<span class="title function_">json</span>(users);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="title function_">next</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="title function_">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">new</span> <span class="title class_">User</span>(req.<span class="property">body</span>);</span><br><span class="line">    <span class="keyword">await</span> user.<span class="title function_">save</span>();</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(user);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="title function_">next</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="MySQL-voi-Sequelize"><a href="#MySQL-voi-Sequelize" class="headerlink" title="MySQL với Sequelize"></a>MySQL với Sequelize</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sequelize</span>, <span class="title class_">DataTypes</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Connect to MySQL</span></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> <span class="title class_">Sequelize</span>(<span class="string">&#x27;database&#x27;</span>, <span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  <span class="attr">dialect</span>: <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// User Model</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = sequelize.<span class="title function_">define</span>(<span class="string">&#x27;User&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">name</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">STRING</span>,</span><br><span class="line">    <span class="attr">allowNull</span>: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">email</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">STRING</span>,</span><br><span class="line">    <span class="attr">allowNull</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">unique</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">age</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">    <span class="attr">validate</span>: &#123;</span><br><span class="line">      <span class="attr">min</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sync database</span></span><br><span class="line">sequelize.<span class="title function_">sync</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Routes</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="title function_">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> users = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findAll</span>();</span><br><span class="line">    res.<span class="title function_">json</span>(users);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="title function_">next</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="9-Authentication-Authorization"><a href="#9-Authentication-Authorization" class="headerlink" title="9. Authentication &amp; Authorization"></a>9. Authentication &amp; Authorization</h2><h3 id="JWT-Authentication"><a href="#JWT-Authentication" class="headerlink" title="JWT Authentication"></a>JWT Authentication</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware để verify JWT</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">authenticateToken</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> authHeader = req.<span class="property">headers</span>[<span class="string">&#x27;authorization&#x27;</span>];</span><br><span class="line">  <span class="keyword">const</span> token = authHeader &amp;&amp; authHeader.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>];</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Access token required&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  jwt.<span class="title function_">verify</span>(token, process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>, <span class="function">(<span class="params">err, user</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid token&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    req.<span class="property">user</span> = user;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Login route</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; email, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123; email &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!user || !<span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(password, user.<span class="property">password</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid credentials&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> token = jwt.<span class="title function_">sign</span>(</span><br><span class="line">      &#123; <span class="attr">userId</span>: user.<span class="property">_id</span>, <span class="attr">email</span>: user.<span class="property">email</span> &#125;,</span><br><span class="line">      process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">      &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;24h&#x27;</span> &#125;</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    res.<span class="title function_">json</span>(&#123; token, <span class="attr">user</span>: &#123; <span class="attr">id</span>: user.<span class="property">_id</span>, <span class="attr">email</span>: user.<span class="property">email</span> &#125; &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Login failed&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Protected route</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/profile&#x27;</span>, authenticateToken, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">user</span>: req.<span class="property">user</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Role-based-Authorization"><a href="#Role-based-Authorization" class="headerlink" title="Role-based Authorization"></a>Role-based Authorization</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">authorize</span> = (<span class="params">...roles</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">user</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Authentication required&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!roles.<span class="title function_">includes</span>(req.<span class="property">user</span>.<span class="property">role</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Insufficient permissions&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin&#x27;</span>, authenticateToken, <span class="title function_">authorize</span>(<span class="string">&#x27;admin&#x27;</span>), <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;Admin access granted&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, authenticateToken, <span class="title function_">authorize</span>(<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;moderator&#x27;</span>), <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;User list&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="10-File-Upload"><a href="#10-File-Upload" class="headerlink" title="10. File Upload"></a>10. File Upload</h2><h3 id="Multer-Middleware"><a href="#Multer-Middleware" class="headerlink" title="Multer Middleware"></a>Multer Middleware</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&#x27;multer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure storage</span></span><br><span class="line"><span class="keyword">const</span> storage = multer.<span class="title function_">diskStorage</span>(&#123;</span><br><span class="line">  <span class="attr">destination</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="string">&#x27;uploads/&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">filename</span>: <span class="function">(<span class="params">req, file, cb</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>() + path.<span class="title function_">extname</span>(file.<span class="property">originalname</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// File filter</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fileFilter</span> = (<span class="params">req, file, cb</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> allowedTypes = <span class="regexp">/jpeg|jpg|png|gif/</span>;</span><br><span class="line">  <span class="keyword">const</span> extname = allowedTypes.<span class="title function_">test</span>(path.<span class="title function_">extname</span>(file.<span class="property">originalname</span>).<span class="title function_">toLowerCase</span>());</span><br><span class="line">  <span class="keyword">const</span> mimetype = allowedTypes.<span class="title function_">test</span>(file.<span class="property">mimetype</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (mimetype &amp;&amp; extname) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">cb</span>(<span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">cb</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Only image files are allowed!&#x27;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123;</span><br><span class="line">  <span class="attr">storage</span>: storage,</span><br><span class="line">  <span class="attr">limits</span>: &#123; <span class="attr">fileSize</span>: <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">5</span> &#125;, <span class="comment">// 5MB</span></span><br><span class="line">  <span class="attr">fileFilter</span>: fileFilter</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Upload routes</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, upload.<span class="title function_">single</span>(<span class="string">&#x27;image&#x27;</span>), <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">    <span class="attr">filename</span>: req.<span class="property">file</span>.<span class="property">filename</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload-multiple&#x27;</span>, upload.<span class="title function_">array</span>(<span class="string">&#x27;images&#x27;</span>, <span class="number">5</span>), <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> filenames = req.<span class="property">files</span>.<span class="title function_">map</span>(<span class="function"><span class="params">file</span> =&gt;</span> file.<span class="property">filename</span>);</span><br><span class="line">  res.<span class="title function_">json</span>(&#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;Files uploaded successfully&#x27;</span>,</span><br><span class="line">    filenames</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="11-Validation"><a href="#11-Validation" class="headerlink" title="11. Validation"></a>11. Validation</h2><h3 id="Express-Validator"><a href="#Express-Validator" class="headerlink" title="Express Validator"></a>Express Validator</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; body, validationResult &#125; = <span class="built_in">require</span>(<span class="string">&#x27;express-validator&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Validation rules</span></span><br><span class="line"><span class="keyword">const</span> validateUser = [</span><br><span class="line">  <span class="title function_">body</span>(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    .<span class="title function_">trim</span>()</span><br><span class="line">    .<span class="title function_">isLength</span>(&#123; <span class="attr">min</span>: <span class="number">2</span>, <span class="attr">max</span>: <span class="number">50</span> &#125;)</span><br><span class="line">    .<span class="title function_">withMessage</span>(<span class="string">&#x27;Name must be between 2 and 50 characters&#x27;</span>),</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">body</span>(<span class="string">&#x27;email&#x27;</span>)</span><br><span class="line">    .<span class="title function_">isEmail</span>()</span><br><span class="line">    .<span class="title function_">normalizeEmail</span>()</span><br><span class="line">    .<span class="title function_">withMessage</span>(<span class="string">&#x27;Must be a valid email&#x27;</span>),</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">body</span>(<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line">    .<span class="title function_">isInt</span>(&#123; <span class="attr">min</span>: <span class="number">0</span>, <span class="attr">max</span>: <span class="number">120</span> &#125;)</span><br><span class="line">    .<span class="title function_">withMessage</span>(<span class="string">&#x27;Age must be between 0 and 120&#x27;</span>),</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">body</span>(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    .<span class="title function_">isLength</span>(&#123; <span class="attr">min</span>: <span class="number">6</span> &#125;)</span><br><span class="line">    .<span class="title function_">withMessage</span>(<span class="string">&#x27;Password must be at least 6 characters&#x27;</span>)</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Validation middleware</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleValidationErrors</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> errors = <span class="title function_">validationResult</span>(req);</span><br><span class="line">  <span class="keyword">if</span> (!errors.<span class="title function_">isEmpty</span>()) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123;</span><br><span class="line">      <span class="attr">errors</span>: errors.<span class="title function_">array</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apply validation</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, validateUser, handleValidationErrors, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Create user logic here</span></span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;User created&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="12-Testing"><a href="#12-Testing" class="headerlink" title="12. Testing"></a>12. Testing</h2><h3 id="Jest-Testing"><a href="#Jest-Testing" class="headerlink" title="Jest Testing"></a>Jest Testing</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// __tests__/app.test.js</span></span><br><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&#x27;supertest&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="built_in">require</span>(<span class="string">&#x27;../app&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;User API&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;GET /users should return all users&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">request</span>(app)</span><br><span class="line">      .<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>)</span><br><span class="line">      .<span class="title function_">expect</span>(<span class="number">200</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(response.<span class="property">body</span>)).<span class="title function_">toBe</span>(<span class="literal">true</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;POST /users should create new user&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> userData = &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;John Doe&#x27;</span>,</span><br><span class="line">      <span class="attr">email</span>: <span class="string">&#x27;john@example.com&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">request</span>(app)</span><br><span class="line">      .<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>)</span><br><span class="line">      .<span class="title function_">send</span>(userData)</span><br><span class="line">      .<span class="title function_">expect</span>(<span class="number">201</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">expect</span>(response.<span class="property">body</span>.<span class="property">name</span>).<span class="title function_">toBe</span>(userData.<span class="property">name</span>);</span><br><span class="line">    <span class="title function_">expect</span>(response.<span class="property">body</span>.<span class="property">email</span>).<span class="title function_">toBe</span>(userData.<span class="property">email</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;GET /users/:id should return user by id&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">request</span>(app)</span><br><span class="line">      .<span class="title function_">get</span>(<span class="string">&#x27;/users/1&#x27;</span>)</span><br><span class="line">      .<span class="title function_">expect</span>(<span class="number">200</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">expect</span>(response.<span class="property">body</span>).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="13-Production-Best-Practices"><a href="#13-Production-Best-Practices" class="headerlink" title="13. Production Best Practices"></a>13. Production Best Practices</h2><h3 id="Environment-Configuration"><a href="#Environment-Configuration" class="headerlink" title="Environment Configuration"></a>Environment Configuration</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config/config.js</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;dotenv&#x27;</span>).<span class="title function_">config</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">development</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>,</span><br><span class="line">    <span class="attr">database</span>: process.<span class="property">env</span>.<span class="property">DEV_DATABASE_URL</span>,</span><br><span class="line">    <span class="attr">jwtSecret</span>: process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">    <span class="attr">corsOrigin</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">production</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>,</span><br><span class="line">    <span class="attr">database</span>: process.<span class="property">env</span>.<span class="property">DATABASE_URL</span>,</span><br><span class="line">    <span class="attr">jwtSecret</span>: process.<span class="property">env</span>.<span class="property">JWT_SECRET</span>,</span><br><span class="line">    <span class="attr">corsOrigin</span>: process.<span class="property">env</span>.<span class="property">CORS_ORIGIN</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = config[process.<span class="property">env</span>.<span class="property">NODE_ENV</span> || <span class="string">&#x27;development&#x27;</span>];</span><br></pre></td></tr></table></figure>

<h3 id="Security-Middleware"><a href="#Security-Middleware" class="headerlink" title="Security Middleware"></a>Security Middleware</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> helmet = <span class="built_in">require</span>(<span class="string">&#x27;helmet&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> rateLimit = <span class="built_in">require</span>(<span class="string">&#x27;express-rate-limit&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> mongoSanitize = <span class="built_in">require</span>(<span class="string">&#x27;express-mongo-sanitize&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> xss = <span class="built_in">require</span>(<span class="string">&#x27;xss-clean&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Security headers</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">helmet</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rate limiting</span></span><br><span class="line"><span class="keyword">const</span> limiter = <span class="title function_">rateLimit</span>(&#123;</span><br><span class="line">  <span class="attr">windowMs</span>: <span class="number">15</span> * <span class="number">60</span> * <span class="number">1000</span>, <span class="comment">// 15 minutes</span></span><br><span class="line">  <span class="attr">max</span>: <span class="number">100</span> <span class="comment">// limit each IP to 100 requests per windowMs</span></span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, limiter);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Data sanitization</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">mongoSanitize</span>()); <span class="comment">// Against NoSQL query injection</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">xss</span>()); <span class="comment">// Against XSS attacks</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Prevent parameter pollution</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">hpp</span>());</span><br></pre></td></tr></table></figure>

<h3 id="Performance-Optimization"><a href="#Performance-Optimization" class="headerlink" title="Performance Optimization"></a>Performance Optimization</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compression = <span class="built_in">require</span>(<span class="string">&#x27;compression&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cache = <span class="built_in">require</span>(<span class="string">&#x27;memory-cache&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Compression</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">compression</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Caching middleware</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">cacheMiddleware</span> = (<span class="params">duration</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> key = <span class="string">&#x27;__express__&#x27;</span> + req.<span class="property">originalUrl</span> || req.<span class="property">url</span>;</span><br><span class="line">    <span class="keyword">const</span> cachedBody = cache.<span class="title function_">get</span>(key);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (cachedBody) &#123;</span><br><span class="line">      res.<span class="title function_">send</span>(cachedBody);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="property">sendResponse</span> = res.<span class="property">send</span>;</span><br><span class="line">      res.<span class="property">send</span> = <span class="function">(<span class="params">body</span>) =&gt;</span> &#123;</span><br><span class="line">        cache.<span class="title function_">put</span>(key, body, duration * <span class="number">1000</span>);</span><br><span class="line">        res.<span class="title function_">sendResponse</span>(body);</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="title function_">next</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apply caching to specific routes</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, <span class="title function_">cacheMiddleware</span>(<span class="number">300</span>), <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Route logic</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="14-Project-thuc-te"><a href="#14-Project-thuc-te" class="headerlink" title="14. Project thực tế"></a>14. Project thực tế</h2><h3 id="REST-API-voi-Express"><a href="#REST-API-voi-Express" class="headerlink" title="REST API với Express"></a>REST API với Express</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> helmet = <span class="built_in">require</span>(<span class="string">&#x27;helmet&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> morgan = <span class="built_in">require</span>(<span class="string">&#x27;morgan&#x27;</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;dotenv&#x27;</span>).<span class="title function_">config</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">helmet</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">morgan</span>(<span class="string">&#x27;combined&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Routes</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/auth&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;./routes/auth&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/users&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;./routes/users&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api/posts&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;./routes/posts&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Error handling</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err.<span class="property">stack</span>);</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Something went wrong!&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>;</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running on port <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = app;</span><br></pre></td></tr></table></figure>

<h3 id="Microservice-voi-Express"><a href="#Microservice-voi-Express" class="headerlink" title="Microservice với Express"></a>Microservice với Express</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user-service/app.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; createClient &#125; = <span class="built_in">require</span>(<span class="string">&#x27;redis&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> redis = <span class="title function_">createClient</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Health check</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/health&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">json</span>(&#123; <span class="attr">status</span>: <span class="string">&#x27;OK&#x27;</span>, <span class="attr">service</span>: <span class="string">&#x27;user-service&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// User routes</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/users/:id&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Check cache first</span></span><br><span class="line">    <span class="keyword">const</span> cached = <span class="keyword">await</span> redis.<span class="title function_">get</span>(<span class="string">`user:<span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">if</span> (cached) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">json</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(cached));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Get from database</span></span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">getUserFromDB</span>(id);</span><br><span class="line">    <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;User not found&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Cache for 1 hour</span></span><br><span class="line">    <span class="keyword">await</span> redis.<span class="title function_">setEx</span>(<span class="string">`user:<span class="subst">$&#123;id&#125;</span>`</span>, <span class="number">3600</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user));</span><br><span class="line">    </span><br><span class="line">    res.<span class="title function_">json</span>(user);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Internal server error&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3001</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;User service running on port 3001&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="📚-Tai-lieu-tham-khao"><a href="#📚-Tai-lieu-tham-khao" class="headerlink" title="📚 Tài liệu tham khảo"></a>📚 Tài liệu tham khảo</h2><ul>
<li><a href="https://expressjs.com/">Express.js Official Documentation</a></li>
<li><a href="https://github.com/expressjs/express">Express.js GitHub Repository</a></li>
<li><a href="https://expressjs.com/en/advanced/best-practices-security.html">Express.js Security Best Practices</a></li>
<li><a href="https://expressjs.com/en/advanced/best-practices-performance.html">Express.js Performance Best Practices</a></li>
</ul>
<h2 id="🎯-Ket-luan"><a href="#🎯-Ket-luan" class="headerlink" title="🎯 Kết luận"></a>🎯 Kết luận</h2><p>Express.js là framework mạnh mẽ và linh hoạt cho Node.js. Với kiến thức từ bài viết này, bạn có thể:</p>
<ul>
<li>✅ Tạo REST APIs hoàn chỉnh</li>
<li>✅ Implement authentication và authorization</li>
<li>✅ Xử lý file uploads</li>
<li>✅ Validate input data</li>
<li>✅ Handle errors gracefully</li>
<li>✅ Optimize performance</li>
<li>✅ Deploy production applications</li>
</ul>
<p><strong>Bước tiếp theo</strong>: Học NestJS cho enterprise applications, hoặc tích hợp với databases như MongoDB&#x2F;PostgreSQL.</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Vui lòng kích hoạt JavaScript để xem các bình luận.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Trang chủ</a></li>
        
          <li><a href="/about/">Giới thiệu</a></li>
        
          <li><a href="/archives/">Bài viết</a></li>
        
          <li><a href="https://github.com/ph4n4n">Dự án</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zero-to-Hero-Express-js-Web-framework-cho-Node-js-tu-co-ban-den-nang-cao"><span class="toc-number">1.</span> <span class="toc-text">Zero to Hero: Express.js - Web framework cho Node.js từ cơ bản đến nâng cao</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Express-js-la-gi"><span class="toc-number">1.1.</span> <span class="toc-text">1. Express.js là gì?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dac-diem-chinh"><span class="toc-number">1.1.1.</span> <span class="toc-text">Đặc điểm chính:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ung-dung-chinh"><span class="toc-number">1.1.2.</span> <span class="toc-text">Ứng dụng chính:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Cai-dat-va-Setup"><span class="toc-number">1.2.</span> <span class="toc-text">2. Cài đặt và Setup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Khoi-tao-project"><span class="toc-number">1.2.1.</span> <span class="toc-text">Khởi tạo project</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#package-json-co-ban"><span class="toc-number">1.2.2.</span> <span class="toc-text">package.json cơ bản</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-co-ban"><span class="toc-number">1.2.3.</span> <span class="toc-text">Server cơ bản</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Routing-co-ban"><span class="toc-number">1.3.</span> <span class="toc-text">3. Routing cơ bản</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-Methods"><span class="toc-number">1.3.1.</span> <span class="toc-text">HTTP Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Route-Parameters"><span class="toc-number">1.3.2.</span> <span class="toc-text">Route Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-Parameters"><span class="toc-number">1.3.3.</span> <span class="toc-text">Query Parameters</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Middleware"><span class="toc-number">1.4.</span> <span class="toc-text">4. Middleware</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Built-in-Middleware"><span class="toc-number">1.4.1.</span> <span class="toc-text">Built-in Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Third-party-Middleware"><span class="toc-number">1.4.2.</span> <span class="toc-text">Third-party Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Custom-Middleware"><span class="toc-number">1.4.3.</span> <span class="toc-text">Custom Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Middleware-Order"><span class="toc-number">1.4.4.</span> <span class="toc-text">Middleware Order</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Route-Organization"><span class="toc-number">1.5.</span> <span class="toc-text">5. Route Organization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Express-Router"><span class="toc-number">1.5.1.</span> <span class="toc-text">Express Router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Modular-Structure"><span class="toc-number">1.5.2.</span> <span class="toc-text">Modular Structure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Route-with-Controllers"><span class="toc-number">1.5.3.</span> <span class="toc-text">Route with Controllers</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Request-va-Response"><span class="toc-number">1.6.</span> <span class="toc-text">6. Request và Response</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Request-Object"><span class="toc-number">1.6.1.</span> <span class="toc-text">Request Object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Response-Object"><span class="toc-number">1.6.2.</span> <span class="toc-text">Response Object</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Error-Handling"><span class="toc-number">1.7.</span> <span class="toc-text">7. Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Try-Catch-trong-Routes"><span class="toc-number">1.7.1.</span> <span class="toc-text">Try-Catch trong Routes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Custom-Error-Classes"><span class="toc-number">1.7.2.</span> <span class="toc-text">Custom Error Classes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Global-Error-Handler"><span class="toc-number">1.7.3.</span> <span class="toc-text">Global Error Handler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Database-Integration"><span class="toc-number">1.8.</span> <span class="toc-text">8. Database Integration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-voi-Mongoose"><span class="toc-number">1.8.1.</span> <span class="toc-text">MongoDB với Mongoose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-voi-Sequelize"><span class="toc-number">1.8.2.</span> <span class="toc-text">MySQL với Sequelize</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Authentication-Authorization"><span class="toc-number">1.9.</span> <span class="toc-text">9. Authentication &amp; Authorization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT-Authentication"><span class="toc-number">1.9.1.</span> <span class="toc-text">JWT Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Role-based-Authorization"><span class="toc-number">1.9.2.</span> <span class="toc-text">Role-based Authorization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-File-Upload"><span class="toc-number">1.10.</span> <span class="toc-text">10. File Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Multer-Middleware"><span class="toc-number">1.10.1.</span> <span class="toc-text">Multer Middleware</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-Validation"><span class="toc-number">1.11.</span> <span class="toc-text">11. Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Express-Validator"><span class="toc-number">1.11.1.</span> <span class="toc-text">Express Validator</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-Testing"><span class="toc-number">1.12.</span> <span class="toc-text">12. Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jest-Testing"><span class="toc-number">1.12.1.</span> <span class="toc-text">Jest Testing</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Production-Best-Practices"><span class="toc-number">1.13.</span> <span class="toc-text">13. Production Best Practices</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Environment-Configuration"><span class="toc-number">1.13.1.</span> <span class="toc-text">Environment Configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security-Middleware"><span class="toc-number">1.13.2.</span> <span class="toc-text">Security Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance-Optimization"><span class="toc-number">1.13.3.</span> <span class="toc-text">Performance Optimization</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-Project-thuc-te"><span class="toc-number">1.14.</span> <span class="toc-text">14. Project thực tế</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#REST-API-voi-Express"><span class="toc-number">1.14.1.</span> <span class="toc-text">REST API với Express</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Microservice-voi-Express"><span class="toc-number">1.14.2.</span> <span class="toc-text">Microservice với Express</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9A-Tai-lieu-tham-khao"><span class="toc-number">1.15.</span> <span class="toc-text">📚 Tài liệu tham khảo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%AF-Ket-luan"><span class="toc-number">1.16.</span> <span class="toc-text">🎯 Kết luận</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&text=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&is_video=false&description=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao&body=Check out this article: https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&title=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&name=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://ph4n4n.github.io/2025/01/27/Zero-to-hero-ExpressJS/&t=Zero to Hero: Express.js - Web Framework Cho Node.js Từ Cơ Bản đếN Nâng Cao"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Chia sẻ</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Về đầu trang</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Bản quyền &copy;
    
    
    2018-2025
    ph4n4n
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Trang chủ</a></li><!--
     --><!--
       --><li><a href="/about/">Giới thiệu</a></li><!--
     --><!--
       --><li><a href="/archives/">Bài viết</a></li><!--
     --><!--
       --><li><a href="https://github.com/ph4n4n">Dự án</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'https-ph4n4n-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->


<script>
(function() {
  var fallbackQuotes = [
    {q: 'Stay hungry, stay foolish.', a: 'Steve Jobs'},
    {q: 'Không có thành công nào mà không phải trả giá.', a: 'Ẩn danh'},
    {q: 'Simplicity is the soul of efficiency.', a: 'Austin Freeman'},
    {q: 'Hãy kiên trì, mọi thứ rồi sẽ ổn.', a: 'Ẩn danh'},
    {q: 'Code is like humor. When you have to explain it, it\'s bad.', a: 'Cory House'},
    {q: 'Chỉ cần bạn không dừng lại thì việc bạn tiến chậm cũng không là vấn đề.', a: 'Khổng Tử'},
    {q: 'The best way to get started is to quit talking and begin doing.', a: 'Walt Disney'},
    {q: 'Muốn đi nhanh thì đi một mình, muốn đi xa thì đi cùng nhau.', a: 'Tục ngữ'},
    {q: 'First, solve the problem. Then, write the code.', a: 'John Johnson'},
    {q: 'Đừng sợ thất bại, hãy sợ không thử.', a: 'Ẩn danh'},
    {q: 'No code no bug, no bug no life.', a: 'ph4n4n'},
    {q: 'No code no bug, no code no food.', a: 'ph4n4n'},
    {q: 'The only way to do great work is to love what you do.', a: 'Steve Jobs'},
    {q: 'Je suis món ennemi.', a: 'ph4n4n'},
    {q: 'Chết không phải lúc trái tim ngừng đập, chết là khi ý chí ngừng tiến lên.', a: 'ChatGPT'},
  ];
  var el = document.getElementById('random-quote');
  function showQuote(q, a) {
    if (el) el.innerHTML = q + (a ? ' <span style="font-size:0.95em;color:#888;">– ' + a + '</span>' : '');
  }
  function showFallback() {
    var r = fallbackQuotes[Math.floor(Math.random() * fallbackQuotes.length)];
    showQuote(r.q, r.a);
  }
  fetch('https://zenquotes.io/api/random')
    .then(function(res) { return res.ok ? res.json() : Promise.reject(); })
    .then(function(data) {
      if (Array.isArray(data) && data[0] && data[0].q) {
        showQuote(data[0].q, data[0].a);
      } else {
        showFallback();
      }
    })
    .catch(showFallback);
})();
</script>
</body>
</html>
